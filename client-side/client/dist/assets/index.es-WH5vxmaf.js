import{aY as Ov,a as Nv,_ as xv}from"./index-OE56k1X-.js";import{e as As,$ as xc}from"./tslib.es6-GVow8CXj.js";import{T as Dv,U as Tv,c as lr,A as $v,W as jv,_ as Mv,e as ie,X as Lv,Y as Mr,Z as _e,$ as Ft,a0 as Vi,a1 as Hv,a2 as at,a3 as Uv,i as zt,a as Bt,a4 as kv,q as Vv,a5 as ds,f as Dc,a6 as hr,a7 as Li,D as lc,g as gs,a8 as it,N as V,a9 as Lr,aa as Fv,ab as zv,ac as vs,ad as pc,ae as Hr,af as Bv,ag as Gv,ah as Wv,ai as fc,aj as Qv,ak as Kv,Q as Jv,al as Yv,am as Zv,an as Xv,ao as em,b as tm,d as rm,ap as im,aq as nm,B as sm,ar as om,F as qs,P as am,h as cm,as as dc,u as gc,y as um,z as hm,at as Br,au as Fr,av as Tc,aw as ms,M as xt,ax as lm,ay as pm}from"./index.es-c5c7QnKt.js";const $c="wc",jc=2,Mc="client",Os=`${$c}@${jc}:${Mc}:`,ys={name:Mc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},vc="WALLETCONNECT_DEEPLINK_CHOICE",fm="proposal",Lc="Proposal expired",dm="session",Hi=ie.SEVEN_DAYS,gm="engine",Ur={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},_s={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},_t={idle:"IDLE",active:"ACTIVE"},vm="request",mm=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var ym=Object.defineProperty,_m=Object.defineProperties,wm=Object.getOwnPropertyDescriptors,mc=Object.getOwnPropertySymbols,Em=Object.prototype.hasOwnProperty,Im=Object.prototype.propertyIsEnumerable,yc=(P,n,i)=>n in P?ym(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,De=(P,n)=>{for(var i in n||(n={}))Em.call(n,i)&&yc(P,i,n[i]);if(mc)for(var i of mc(n))Im.call(n,i)&&yc(P,i,n[i]);return P},kr=(P,n)=>_m(P,wm(n));class bm extends jv{constructor(n){super(n),this.name=gm,this.events=new xc,this.initialized=!1,this.ignoredPayloadTypes=[Mv],this.requestQueue={state:_t.idle,queue:[]},this.sessionRequestQueue={state:_t.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Ur)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const o=kr(De({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(o);const{pairingTopic:c,requiredNamespaces:f,optionalNamespaces:y,sessionProperties:I,relays:R}=o;let q=c,j,M=!1;if(q&&(M=this.client.core.pairing.pairings.get(q).active),!q||!M){const{topic:fe,uri:ue}=await this.client.core.pairing.create();q=fe,j=ue}const H=await this.client.core.crypto.generateKeyPair(),J=De({requiredNamespaces:f,optionalNamespaces:y,relays:R??[{protocol:Lv}],proposer:{publicKey:H,metadata:this.client.metadata}},I&&{sessionProperties:I}),{reject:F,resolve:Ce,done:pe}=Mr(ie.FIVE_MINUTES,Lc);if(this.events.once(_e("session_connect"),async({error:fe,session:ue})=>{if(fe)F(fe);else if(ue){ue.self.publicKey=H;const we=kr(De({},ue),{requiredNamespaces:ue.requiredNamespaces,optionalNamespaces:ue.optionalNamespaces});await this.client.session.set(ue.topic,we),await this.setExpiry(ue.topic,ue.expiry),q&&await this.client.core.pairing.updateMetadata({topic:q,metadata:ue.peer.metadata}),Ce(we)}}),!q){const{message:fe}=V("NO_MATCHING_KEY",`connect() pairing topic: ${q}`);throw new Error(fe)}const Ae=await this.sendRequest({topic:q,method:"wc_sessionPropose",params:J}),Wt=Ft(ie.FIVE_MINUTES);return await this.setProposal(Ae,De({id:Ae,expiry:Wt},J)),{uri:j,approval:pe}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:o,relayProtocol:c,namespaces:f,sessionProperties:y}=i,I=this.client.proposal.get(o);let{pairingTopic:R,proposer:q,requiredNamespaces:j,optionalNamespaces:M}=I;R=R||"",Vi(j)||(j=Hv(f,"approve()"));const H=await this.client.core.crypto.generateKeyPair(),J=q.publicKey,F=await this.client.core.crypto.generateSharedKey(H,J);R&&o&&(await this.client.core.pairing.updateMetadata({topic:R,metadata:q.metadata}),await this.sendResult({id:o,topic:R,result:{relay:{protocol:c??"irn"},responderPublicKey:H}}),await this.client.proposal.delete(o,at("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:R}));const Ce=De({relay:{protocol:c??"irn"},namespaces:f,requiredNamespaces:j,optionalNamespaces:M,pairingTopic:R,controller:{publicKey:H,metadata:this.client.metadata},expiry:Ft(Hi)},y&&{sessionProperties:y});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:Ce,throwOnFailedPublish:!0});const pe=kr(De({},Ce),{topic:F,pairingTopic:R,acknowledged:!1,self:Ce.controller,peer:{publicKey:q.publicKey,metadata:q.metadata},controller:H});return await this.client.session.set(F,pe),await this.setExpiry(F,Ft(Hi)),{topic:F,acknowledged:()=>new Promise(Ae=>setTimeout(()=>Ae(this.client.session.get(F)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:o,reason:c}=i,{pairingTopic:f}=this.client.proposal.get(o);f&&(await this.sendError(o,f,c),await this.client.proposal.delete(o,at("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:o,namespaces:c}=i,f=await this.sendRequest({topic:o,method:"wc_sessionUpdate",params:{namespaces:c}}),{done:y,resolve:I,reject:R}=Mr();return this.events.once(_e("session_update",f),({error:q})=>{q?R(q):I()}),await this.client.session.update(o,{namespaces:c}),{acknowledged:y}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:o}=i,c=await this.sendRequest({topic:o,method:"wc_sessionExtend",params:{}}),{done:f,resolve:y,reject:I}=Mr();return this.events.once(_e("session_extend",c),({error:R})=>{R?I(R):y()}),await this.setExpiry(o,Ft(Hi)),{acknowledged:f}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:o,request:c,topic:f,expiry:y}=i,I=am(),{done:R,resolve:q,reject:j}=Mr(y,"Request expired. Please try again.");return this.events.once(_e("session_request",I),({error:M,result:H})=>{M?j(M):q(H)}),await Promise.all([new Promise(async M=>{await this.sendRequest({clientRpcId:I,topic:f,method:"wc_sessionRequest",params:{request:c,chainId:o},expiry:y,throwOnFailedPublish:!0}).catch(H=>j(H)),this.client.events.emit("session_request_sent",{topic:f,request:c,chainId:o,id:I}),M()}),new Promise(async M=>{const H=await this.client.core.storage.getItem(vc);Uv({id:I,topic:f,wcDeepLink:H}),M()}),R()]).then(M=>M[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:o,response:c}=i,{id:f}=c;zt(c)?await this.sendResult({id:f,topic:o,result:c.result,throwOnFailedPublish:!0}):Bt(c)&&await this.sendError(f,o,c.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:o}=i;if(this.client.session.keys.includes(o)){const c=await this.sendRequest({topic:o,method:"wc_sessionPing",params:{}}),{done:f,resolve:y,reject:I}=Mr();this.events.once(_e("session_ping",c),({error:R})=>{R?I(R):y()}),await f()}else this.client.core.pairing.pairings.keys.includes(o)&&await this.client.core.pairing.ping({topic:o})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:o,event:c,chainId:f}=i;await this.sendRequest({topic:o,method:"wc_sessionEvent",params:{event:c,chainId:f}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:o}=i;this.client.session.keys.includes(o)?(await this.sendRequest({topic:o,method:"wc_sessionDelete",params:at("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(o)):await this.client.core.pairing.disconnect({topic:o})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(o=>kv(o,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const o=this.client.core.pairing.pairings.get(i.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(f=>{var y,I;return((y=f.peerMetadata)==null?void 0:y.url)&&((I=f.peerMetadata)==null?void 0:I.url)===i.peer.metadata.url&&f.topic&&f.topic!==o.topic});if(c.length===0)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(f=>this.client.core.pairing.disconnect({topic:f.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(o){this.client.logger.error(o)}},this.deleteSession=async(i,o)=>{const{self:c}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,at("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),o||this.client.core.expirer.del(i),this.client.core.storage.removeItem(vc).catch(f=>this.client.logger.warn(f))},this.deleteProposal=async(i,o)=>{await Promise.all([this.client.proposal.delete(i,at("USER_DISCONNECTED")),o?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,o,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,o),c?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(f=>f.id!==i),c&&(this.sessionRequestQueue.state=_t.idle)},this.setExpiry=async(i,o)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:o}),this.client.core.expirer.set(i,o)},this.setProposal=async(i,o)=>{await this.client.proposal.set(i,o),this.client.core.expirer.set(i,o.expiry)},this.setPendingSessionRequest=async i=>{const o=Ur.wc_sessionRequest.req.ttl,{id:c,topic:f,params:y,verifyContext:I}=i;await this.client.pendingRequest.set(c,{id:c,topic:f,params:y,verifyContext:I}),o&&this.client.core.expirer.set(c,Ft(o))},this.sendRequest=async i=>{const{topic:o,method:c,params:f,expiry:y,relayRpcId:I,clientRpcId:R,throwOnFailedPublish:q}=i,j=gs(c,f,R);if(Vv()&&mm.includes(c)){const J=ds(JSON.stringify(j));this.client.core.verify.register({attestationId:J})}const M=await this.client.core.crypto.encode(o,j),H=Ur[c].req;return y&&(H.ttl=y),I&&(H.id=I),this.client.core.history.set(o,j),q?(H.internal=kr(De({},H.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,M,H)):this.client.core.relayer.publish(o,M,H).catch(J=>this.client.logger.error(J)),j.id},this.sendResult=async i=>{const{id:o,topic:c,result:f,throwOnFailedPublish:y}=i,I=cm(o,f),R=await this.client.core.crypto.encode(c,I),q=await this.client.core.history.get(c,o),j=Ur[q.request.method].res;y?(j.internal=kr(De({},j.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(c,R,j)):this.client.core.relayer.publish(c,R,j).catch(M=>this.client.logger.error(M)),await this.client.core.history.resolve(I)},this.sendError=async(i,o,c)=>{const f=Dc(i,c),y=await this.client.core.crypto.encode(o,f),I=await this.client.core.history.get(o,i),R=Ur[I.request.method].res;this.client.core.relayer.publish(o,y,R),await this.client.core.history.resolve(f)},this.cleanup=async()=>{const i=[],o=[];this.client.session.getAll().forEach(c=>{hr(c.expiry)&&i.push(c.topic)}),this.client.proposal.getAll().forEach(c=>{hr(c.expiry)&&o.push(c.id)}),await Promise.all([...i.map(c=>this.deleteSession(c)),...o.map(c=>this.deleteProposal(c))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===_t.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=_t.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(o=>setTimeout(o,300))}catch(o){this.client.logger.warn(o)}}this.requestQueue.state=_t.idle},this.processRequest=i=>{const{topic:o,payload:c}=i,f=c.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeRequest(o,c);case"wc_sessionSettle":return this.onSessionSettleRequest(o,c);case"wc_sessionUpdate":return this.onSessionUpdateRequest(o,c);case"wc_sessionExtend":return this.onSessionExtendRequest(o,c);case"wc_sessionPing":return this.onSessionPingRequest(o,c);case"wc_sessionDelete":return this.onSessionDeleteRequest(o,c);case"wc_sessionRequest":return this.onSessionRequest(o,c);case"wc_sessionEvent":return this.onSessionEventRequest(o,c);default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async i=>{const{topic:o,payload:c}=i,f=(await this.client.core.history.get(o,c.id)).request.method;switch(f){case"wc_sessionPropose":return this.onSessionProposeResponse(o,c);case"wc_sessionSettle":return this.onSessionSettleResponse(o,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(o,c);case"wc_sessionExtend":return this.onSessionExtendResponse(o,c);case"wc_sessionPing":return this.onSessionPingResponse(o,c);case"wc_sessionRequest":return this.onSessionRequestResponse(o,c);default:return this.client.logger.info(`Unsupported response method ${f}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:o}=i,{message:c}=V("MISSING_OR_INVALID",`Decoded payload on topic ${o} is not identifiable as a JSON-RPC request or a response.`);throw new Error(c)},this.onSessionProposeRequest=async(i,o)=>{const{params:c,id:f}=o;try{this.isValidConnect(De({},o.params));const y=Ft(ie.FIVE_MINUTES),I=De({id:f,pairingTopic:i,expiry:y},c);await this.setProposal(f,I);const R=ds(JSON.stringify(o)),q=await this.getVerifyContext(R,I.proposer.metadata);this.client.events.emit("session_proposal",{id:f,params:I,verifyContext:q})}catch(y){await this.sendError(f,i,y),this.client.logger.error(y)}},this.onSessionProposeResponse=async(i,o)=>{const{id:c}=o;if(zt(o)){const{result:f}=o;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:f});const y=this.client.proposal.get(c);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:y});const I=y.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:I});const R=f.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:R});const q=await this.client.core.crypto.generateSharedKey(I,R);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:q});const j=await this.client.core.relayer.subscribe(q);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:j}),await this.client.core.pairing.activate({topic:i})}else Bt(o)&&(await this.client.proposal.delete(c,at("USER_DISCONNECTED")),this.events.emit(_e("session_connect"),{error:o.error}))},this.onSessionSettleRequest=async(i,o)=>{const{id:c,params:f}=o;try{this.isValidSessionSettleRequest(f);const{relay:y,controller:I,expiry:R,namespaces:q,requiredNamespaces:j,optionalNamespaces:M,sessionProperties:H,pairingTopic:J}=o.params,F=De({topic:i,relay:y,expiry:R,namespaces:q,acknowledged:!0,pairingTopic:J,requiredNamespaces:j,optionalNamespaces:M,controller:I.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:I.publicKey,metadata:I.metadata}},H&&{sessionProperties:H});await this.sendResult({id:o.id,topic:i,result:!0}),this.events.emit(_e("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.onSessionSettleResponse=async(i,o)=>{const{id:c}=o;zt(o)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(_e("session_approve",c),{})):Bt(o)&&(await this.client.session.delete(i,at("USER_DISCONNECTED")),this.events.emit(_e("session_approve",c),{error:o.error}))},this.onSessionUpdateRequest=async(i,o)=>{const{params:c,id:f}=o;try{const y=`${i}_session_update`,I=Li.get(y);if(I&&this.isRequestOutOfSync(I,f)){this.client.logger.info(`Discarding out of sync request - ${f}`);return}this.isValidUpdate(De({topic:i},c)),await this.client.session.update(i,{namespaces:c.namespaces}),await this.sendResult({id:f,topic:i,result:!0}),this.client.events.emit("session_update",{id:f,topic:i,params:c}),Li.set(y,f)}catch(y){await this.sendError(f,i,y),this.client.logger.error(y)}},this.isRequestOutOfSync=(i,o)=>parseInt(o.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_update",c),{}):Bt(o)&&this.events.emit(_e("session_update",c),{error:o.error})},this.onSessionExtendRequest=async(i,o)=>{const{id:c}=o;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Ft(Hi)),await this.sendResult({id:c,topic:i,result:!0}),this.client.events.emit("session_extend",{id:c,topic:i})}catch(f){await this.sendError(c,i,f),this.client.logger.error(f)}},this.onSessionExtendResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_extend",c),{}):Bt(o)&&this.events.emit(_e("session_extend",c),{error:o.error})},this.onSessionPingRequest=async(i,o)=>{const{id:c}=o;try{this.isValidPing({topic:i}),await this.sendResult({id:c,topic:i,result:!0}),this.client.events.emit("session_ping",{id:c,topic:i})}catch(f){await this.sendError(c,i,f),this.client.logger.error(f)}},this.onSessionPingResponse=(i,o)=>{const{id:c}=o;setTimeout(()=>{zt(o)?this.events.emit(_e("session_ping",c),{}):Bt(o)&&this.events.emit(_e("session_ping",c),{error:o.error})},500)},this.onSessionDeleteRequest=async(i,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:i,reason:o.params}),await Promise.all([new Promise(f=>{this.client.core.relayer.once(lc.publish,async()=>{f(await this.deleteSession(i))})}),this.sendResult({id:c,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:c,topic:i})}catch(f){this.client.logger.error(f)}},this.onSessionRequest=async(i,o)=>{const{id:c,params:f}=o;try{this.isValidRequest(De({topic:i},f));const y=ds(JSON.stringify(gs("wc_sessionRequest",f,c))),I=this.client.session.get(i),R=await this.getVerifyContext(y,I.peer.metadata),q={id:c,topic:i,params:f,verifyContext:R};await this.setPendingSessionRequest(q),this.addSessionRequestToSessionRequestQueue(q),this.processSessionRequestQueue()}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.onSessionRequestResponse=(i,o)=>{const{id:c}=o;zt(o)?this.events.emit(_e("session_request",c),{result:o.result}):Bt(o)&&this.events.emit(_e("session_request",c),{error:o.error})},this.onSessionEventRequest=async(i,o)=>{const{id:c,params:f}=o;try{const y=`${i}_session_event_${f.event.name}`,I=Li.get(y);if(I&&this.isRequestOutOfSync(I,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidEmit(De({topic:i},f)),this.client.events.emit("session_event",{id:c,topic:i,params:f}),Li.set(y,c)}catch(y){await this.sendError(c,i,y),this.client.logger.error(y)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=_t.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===_t.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=_t.active,this.client.events.emit("session_request",i)}catch(o){this.client.logger.error(o)}},this.onPairingCreated=i=>{if(i.active)return;const o=this.client.proposal.getAll().find(c=>c.pairingTopic===i.topic);o&&this.onSessionProposeRequest(i.topic,gs("wc_sessionPropose",{requiredNamespaces:o.requiredNamespaces,optionalNamespaces:o.optionalNamespaces,relays:o.relays,proposer:o.proposer},o.id))},this.isValidConnect=async i=>{if(!it(i)){const{message:R}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(R)}const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:y,relays:I}=i;if(Lr(o)||await this.isValidPairingTopic(o),!Fv(I,!0)){const{message:R}=V("MISSING_OR_INVALID",`connect() relays: ${I}`);throw new Error(R)}!Lr(c)&&Vi(c)!==0&&this.validateNamespaces(c,"requiredNamespaces"),!Lr(f)&&Vi(f)!==0&&this.validateNamespaces(f,"optionalNamespaces"),Lr(y)||this.validateSessionProps(y,"sessionProperties")},this.validateNamespaces=(i,o)=>{const c=zv(i,"connect()",o);if(c)throw new Error(c.message)},this.isValidApprove=async i=>{if(!it(i))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:o,namespaces:c,relayProtocol:f,sessionProperties:y}=i;await this.isValidProposalId(o);const I=this.client.proposal.get(o),R=vs(c,"approve()");if(R)throw new Error(R.message);const q=pc(I.requiredNamespaces,c,"approve()");if(q)throw new Error(q.message);if(!Hr(f,!0)){const{message:j}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${f}`);throw new Error(j)}Lr(y)||this.validateSessionProps(y,"sessionProperties")},this.isValidReject=async i=>{if(!it(i)){const{message:f}=V("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(f)}const{id:o,reason:c}=i;if(await this.isValidProposalId(o),!Bv(c)){const{message:f}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidSessionSettleRequest=i=>{if(!it(i)){const{message:q}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(q)}const{relay:o,controller:c,namespaces:f,expiry:y}=i;if(!Gv(o)){const{message:q}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(q)}const I=Wv(c,"onSessionSettleRequest()");if(I)throw new Error(I.message);const R=vs(f,"onSessionSettleRequest()");if(R)throw new Error(R.message);if(hr(y)){const{message:q}=V("EXPIRED","onSessionSettleRequest()");throw new Error(q)}},this.isValidUpdate=async i=>{if(!it(i)){const{message:R}=V("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(R)}const{topic:o,namespaces:c}=i;await this.isValidSessionTopic(o);const f=this.client.session.get(o),y=vs(c,"update()");if(y)throw new Error(y.message);const I=pc(f.requiredNamespaces,c,"update()");if(I)throw new Error(I.message)},this.isValidExtend=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionTopic(o)},this.isValidRequest=async i=>{if(!it(i)){const{message:R}=V("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(R)}const{topic:o,request:c,chainId:f,expiry:y}=i;await this.isValidSessionTopic(o);const{namespaces:I}=this.client.session.get(o);if(!fc(I,f)){const{message:R}=V("MISSING_OR_INVALID",`request() chainId: ${f}`);throw new Error(R)}if(!Qv(c)){const{message:R}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(c)}`);throw new Error(R)}if(!Kv(I,f,c.method)){const{message:R}=V("MISSING_OR_INVALID",`request() method: ${c.method}`);throw new Error(R)}if(y&&!Jv(y,_s)){const{message:R}=V("MISSING_OR_INVALID",`request() expiry: ${y}. Expiry must be a number (in seconds) between ${_s.min} and ${_s.max}`);throw new Error(R)}},this.isValidRespond=async i=>{if(!it(i)){const{message:f}=V("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(f)}const{topic:o,response:c}=i;if(await this.isValidSessionTopic(o),!Yv(c)){const{message:f}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidPing=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionOrPairingTopic(o)},this.isValidEmit=async i=>{if(!it(i)){const{message:I}=V("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(I)}const{topic:o,event:c,chainId:f}=i;await this.isValidSessionTopic(o);const{namespaces:y}=this.client.session.get(o);if(!fc(y,f)){const{message:I}=V("MISSING_OR_INVALID",`emit() chainId: ${f}`);throw new Error(I)}if(!Zv(c)){const{message:I}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw new Error(I)}if(!Xv(y,f,c.name)){const{message:I}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw new Error(I)}},this.isValidDisconnect=async i=>{if(!it(i)){const{message:c}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(c)}const{topic:o}=i;await this.isValidSessionOrPairingTopic(o)},this.getVerifyContext=async(i,o)=>{const c={verified:{verifyUrl:o.verifyUrl||em,validation:"UNKNOWN",origin:o.url||""}};try{const f=await this.client.core.verify.resolve({attestationId:i,verifyUrl:o.verifyUrl});f&&(c.verified.origin=f.origin,c.verified.isScam=f.isScam,c.verified.validation=f.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(f){this.client.logger.info(f)}return this.client.logger.info(`Verify context: ${JSON.stringify(c)}`),c},this.validateSessionProps=(i,o)=>{Object.values(i).forEach(c=>{if(!Hr(c,!1)){const{message:f}=V("MISSING_OR_INVALID",`${o} must be in Record<string, string> format. Received: ${JSON.stringify(c)}`);throw new Error(f)}})}}async isInitialized(){if(!this.initialized){const{message:n}=V("NOT_INITIALIZED",this.name);throw new Error(n)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(lc.message,async n=>{const{topic:i,message:o}=n;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(o)))return;const c=await this.client.core.crypto.decode(i,o);try{tm(c)?(this.client.core.history.set(i,c),this.onRelayEventRequest({topic:i,payload:c})):rm(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:i,payload:c}),this.client.core.history.delete(i,c.id)):this.onRelayEventUnknownPayload({topic:i,payload:c})}catch(f){this.client.logger.error(f)}})}registerExpirerEvents(){this.client.core.expirer.on(im.expired,async n=>{const{topic:i,id:o}=nm(n.target);if(o&&this.client.pendingRequest.keys.includes(o))return await this.deletePendingSessionRequest(o,V("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):o&&(await this.deleteProposal(o,!0),this.client.events.emit("proposal_expire",{id:o}))})}registerPairingEvents(){this.client.core.pairing.events.on(sm.create,n=>this.onPairingCreated(n))}isValidPairingTopic(n){if(!Hr(n,!1)){const{message:i}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.core.pairing.pairings.get(n).expiry)){const{message:i}=V("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}async isValidSessionTopic(n){if(!Hr(n,!1)){const{message:i}=V("MISSING_OR_INVALID",`session topic should be a string: ${n}`);throw new Error(i)}if(!this.client.session.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.session.get(n).expiry)){await this.deleteSession(n);const{message:i}=V("EXPIRED",`session topic: ${n}`);throw new Error(i)}}async isValidSessionOrPairingTopic(n){if(this.client.session.keys.includes(n))await this.isValidSessionTopic(n);else if(this.client.core.pairing.pairings.keys.includes(n))this.isValidPairingTopic(n);else if(Hr(n,!1)){const{message:i}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${n}`);throw new Error(i)}else{const{message:i}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${n}`);throw new Error(i)}}async isValidProposalId(n){if(!om(n)){const{message:i}=V("MISSING_OR_INVALID",`proposal id should be a number: ${n}`);throw new Error(i)}if(!this.client.proposal.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${n}`);throw new Error(i)}if(hr(this.client.proposal.get(n).expiry)){await this.deleteProposal(n);const{message:i}=V("EXPIRED",`proposal id: ${n}`);throw new Error(i)}}}class Pm extends qs{constructor(n,i){super(n,i,fm,Os),this.core=n,this.logger=i}}class Sm extends qs{constructor(n,i){super(n,i,dm,Os),this.core=n,this.logger=i}}class Rm extends qs{constructor(n,i){super(n,i,vm,Os,o=>o.id),this.core=n,this.logger=i}}let Cm=class Hc extends Dv{constructor(n){super(n),this.protocol=$c,this.version=jc,this.name=ys.name,this.events=new As.EventEmitter,this.on=(o,c)=>this.events.on(o,c),this.once=(o,c)=>this.events.once(o,c),this.off=(o,c)=>this.events.off(o,c),this.removeListener=(o,c)=>this.events.removeListener(o,c),this.removeAllListeners=o=>this.events.removeAllListeners(o),this.connect=async o=>{try{return await this.engine.connect(o)}catch(c){throw this.logger.error(c.message),c}},this.pair=async o=>{try{return await this.engine.pair(o)}catch(c){throw this.logger.error(c.message),c}},this.approve=async o=>{try{return await this.engine.approve(o)}catch(c){throw this.logger.error(c.message),c}},this.reject=async o=>{try{return await this.engine.reject(o)}catch(c){throw this.logger.error(c.message),c}},this.update=async o=>{try{return await this.engine.update(o)}catch(c){throw this.logger.error(c.message),c}},this.extend=async o=>{try{return await this.engine.extend(o)}catch(c){throw this.logger.error(c.message),c}},this.request=async o=>{try{return await this.engine.request(o)}catch(c){throw this.logger.error(c.message),c}},this.respond=async o=>{try{return await this.engine.respond(o)}catch(c){throw this.logger.error(c.message),c}},this.ping=async o=>{try{return await this.engine.ping(o)}catch(c){throw this.logger.error(c.message),c}},this.emit=async o=>{try{return await this.engine.emit(o)}catch(c){throw this.logger.error(c.message),c}},this.disconnect=async o=>{try{return await this.engine.disconnect(o)}catch(c){throw this.logger.error(c.message),c}},this.find=o=>{try{return this.engine.find(o)}catch(c){throw this.logger.error(c.message),c}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(o){throw this.logger.error(o.message),o}},this.name=(n==null?void 0:n.name)||ys.name,this.metadata=(n==null?void 0:n.metadata)||Tv();const i=typeof(n==null?void 0:n.logger)<"u"&&typeof(n==null?void 0:n.logger)!="string"?n.logger:lr.pino(lr.getDefaultLoggerOptions({level:(n==null?void 0:n.logger)||ys.logger}));this.core=(n==null?void 0:n.core)||new $v(n),this.logger=lr.generateChildLogger(i,this.name),this.session=new Sm(this.core,this.logger),this.proposal=new Pm(this.core,this.logger),this.pendingRequest=new Rm(this.core,this.logger),this.engine=new bm(this)}static async init(n){const i=new Hc(n);return await i.initialize(),i}get context(){return lr.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(n){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(n.message),n}}};var Ps={exports:{}};(function(P,n){var i=typeof self<"u"?self:Ov,o=function(){function f(){this.fetch=!1,this.DOMException=i.DOMException}return f.prototype=i,new f}();(function(f){(function(y){var I={searchParams:"URLSearchParams"in f,iterable:"Symbol"in f&&"iterator"in Symbol,blob:"FileReader"in f&&"Blob"in f&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in f,arrayBuffer:"ArrayBuffer"in f};function R(m){return m&&DataView.prototype.isPrototypeOf(m)}if(I.arrayBuffer)var q=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],j=ArrayBuffer.isView||function(m){return m&&q.indexOf(Object.prototype.toString.call(m))>-1};function M(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function H(m){return typeof m!="string"&&(m=String(m)),m}function J(m){var S={next:function(){var U=m.shift();return{done:U===void 0,value:U}}};return I.iterable&&(S[Symbol.iterator]=function(){return S}),S}function F(m){this.map={},m instanceof F?m.forEach(function(S,U){this.append(U,S)},this):Array.isArray(m)?m.forEach(function(S){this.append(S[0],S[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(S){this.append(S,m[S])},this)}F.prototype.append=function(m,S){m=M(m),S=H(S);var U=this.map[m];this.map[m]=U?U+", "+S:S},F.prototype.delete=function(m){delete this.map[M(m)]},F.prototype.get=function(m){return m=M(m),this.has(m)?this.map[m]:null},F.prototype.has=function(m){return this.map.hasOwnProperty(M(m))},F.prototype.set=function(m,S){this.map[M(m)]=H(S)},F.prototype.forEach=function(m,S){for(var U in this.map)this.map.hasOwnProperty(U)&&m.call(S,this.map[U],U,this)},F.prototype.keys=function(){var m=[];return this.forEach(function(S,U){m.push(U)}),J(m)},F.prototype.values=function(){var m=[];return this.forEach(function(S){m.push(S)}),J(m)},F.prototype.entries=function(){var m=[];return this.forEach(function(S,U){m.push([U,S])}),J(m)},I.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function Ce(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function pe(m){return new Promise(function(S,U){m.onload=function(){S(m.result)},m.onerror=function(){U(m.error)}})}function Ae(m){var S=new FileReader,U=pe(S);return S.readAsArrayBuffer(m),U}function Wt(m){var S=new FileReader,U=pe(S);return S.readAsText(m),U}function fe(m){for(var S=new Uint8Array(m),U=new Array(S.length),ne=0;ne<S.length;ne++)U[ne]=String.fromCharCode(S[ne]);return U.join("")}function ue(m){if(m.slice)return m.slice(0);var S=new Uint8Array(m.byteLength);return S.set(new Uint8Array(m)),S.buffer}function we(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:I.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:I.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:I.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():I.arrayBuffer&&I.blob&&R(m)?(this._bodyArrayBuffer=ue(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):I.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||j(m))?this._bodyArrayBuffer=ue(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):I.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},I.blob&&(this.blob=function(){var m=Ce(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Ce(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ae)}),this.text=function(){var m=Ce(this);if(m)return m;if(this._bodyBlob)return Wt(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},I.formData&&(this.formData=function(){return this.text().then(pr)}),this.json=function(){return this.text().then(JSON.parse)},this}var Et=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Je(m){var S=m.toUpperCase();return Et.indexOf(S)>-1?S:m}function Te(m,S){S=S||{};var U=S.body;if(m instanceof Te){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,S.headers||(this.headers=new F(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!U&&m._bodyInit!=null&&(U=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new F(S.headers)),this.method=Je(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&U)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(U)}Te.prototype.clone=function(){return new Te(this,{body:this._bodyInit})};function pr(m){var S=new FormData;return m.trim().split("&").forEach(function(U){if(U){var ne=U.split("="),ee=ne.shift().replace(/\+/g," "),Y=ne.join("=").replace(/\+/g," ");S.append(decodeURIComponent(ee),decodeURIComponent(Y))}}),S}function zi(m){var S=new F,U=m.replace(/\r?\n[\t ]+/g," ");return U.split(/\r?\n/).forEach(function(ne){var ee=ne.split(":"),Y=ee.shift().trim();if(Y){var ct=ee.join(":").trim();S.append(Y,ct)}}),S}we.call(Te.prototype);function ke(m,S){S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"OK",this.headers=new F(S.headers),this.url=S.url||"",this._initBody(m)}we.call(ke.prototype),ke.prototype.clone=function(){return new ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},ke.error=function(){var m=new ke(null,{status:0,statusText:""});return m.type="error",m};var Bi=[301,302,303,307,308];ke.redirect=function(m,S){if(Bi.indexOf(S)===-1)throw new RangeError("Invalid status code");return new ke(null,{status:S,headers:{location:m}})},y.DOMException=f.DOMException;try{new y.DOMException}catch{y.DOMException=function(S,U){this.message=S,this.name=U;var ne=Error(S);this.stack=ne.stack},y.DOMException.prototype=Object.create(Error.prototype),y.DOMException.prototype.constructor=y.DOMException}function fr(m,S){return new Promise(function(U,ne){var ee=new Te(m,S);if(ee.signal&&ee.signal.aborted)return ne(new y.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function ct(){Y.abort()}Y.onload=function(){var Ee={status:Y.status,statusText:Y.statusText,headers:zi(Y.getAllResponseHeaders()||"")};Ee.url="responseURL"in Y?Y.responseURL:Ee.headers.get("X-Request-URL");var dr="response"in Y?Y.response:Y.responseText;U(new ke(dr,Ee))},Y.onerror=function(){ne(new TypeError("Network request failed"))},Y.ontimeout=function(){ne(new TypeError("Network request failed"))},Y.onabort=function(){ne(new y.DOMException("Aborted","AbortError"))},Y.open(ee.method,ee.url,!0),ee.credentials==="include"?Y.withCredentials=!0:ee.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&I.blob&&(Y.responseType="blob"),ee.headers.forEach(function(Ee,dr){Y.setRequestHeader(dr,Ee)}),ee.signal&&(ee.signal.addEventListener("abort",ct),Y.onreadystatechange=function(){Y.readyState===4&&ee.signal.removeEventListener("abort",ct)}),Y.send(typeof ee._bodyInit>"u"?null:ee._bodyInit)})}return fr.polyfill=!0,f.fetch||(f.fetch=fr,f.Headers=F,f.Request=Te,f.Response=ke),y.Headers=F,y.Request=Te,y.Response=ke,y.fetch=fr,Object.defineProperty(y,"__esModule",{value:!0}),y})({})})(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var c=o;n=c.fetch,n.default=c.fetch,n.fetch=c.fetch,n.Headers=c.Headers,n.Request=c.Request,n.Response=c.Response,P.exports=n})(Ps,Ps.exports);var Am=Ps.exports;const _c=Nv(Am),qm={Accept:"application/json","Content-Type":"application/json"},Om="POST",wc={headers:qm,method:Om},Ec=10;class Dt{constructor(n,i=!1){if(this.url=n,this.disableProviderPing=i,this.events=new As.EventEmitter,this.isAvailable=!1,this.registering=!1,!dc(n))throw new Error(`Provided URL is not compatible with HTTP connection: ${n}`);this.url=n,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(n,i){this.events.on(n,i)}once(n,i){this.events.once(n,i)}off(n,i){this.events.off(n,i)}removeListener(n,i){this.events.removeListener(n,i)}async open(n=this.url){await this.register(n)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(n,i){this.isAvailable||await this.register();try{const o=gc(n),f=await(await _c(this.url,Object.assign(Object.assign({},wc),{body:o}))).json();this.onPayload({data:f})}catch(o){this.onError(n.id,o)}}async register(n=this.url){if(!dc(n))throw new Error(`Provided URL is not compatible with HTTP connection: ${n}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((o,c)=>{this.events.once("register_error",f=>{this.resetMaxListeners(),c(f)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return c(new Error("HTTP connection is missing or invalid"));o()})})}this.url=n,this.registering=!0;try{if(!this.disableProviderPing){const i=gc({id:1,jsonrpc:"2.0",method:"test",params:[]});await _c(n,Object.assign(Object.assign({},wc),{body:i}))}this.onOpen()}catch(i){const o=this.parseError(i);throw this.events.emit("register_error",o),this.onClose(),o}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(n){if(typeof n.data>"u")return;const i=typeof n.data=="string"?um(n.data):n.data;this.events.emit("payload",i)}onError(n,i){const o=this.parseError(i),c=o.message||o.toString(),f=Dc(n,c);this.events.emit("payload",f)}parseError(n,i=this.url){return hm(n,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ec&&this.events.setMaxListeners(Ec)}}const Ic="error",Nm="wss://relay.walletconnect.com",xm="wc",Dm="universal_provider",bc=`${xm}@2:${Dm}:`,Tm="https://rpc.walletconnect.com/v1/",wt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ss={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(P,n){(function(){var i,o="4.17.21",c=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",y="Expected a function",I="Invalid `variable` option passed into `_.template`",R="__lodash_hash_undefined__",q=500,j="__lodash_placeholder__",M=1,H=2,J=4,F=1,Ce=2,pe=1,Ae=2,Wt=4,fe=8,ue=16,we=32,Et=64,Je=128,Te=256,pr=512,zi=30,ke="...",Bi=800,fr=16,m=1,S=2,U=3,ne=1/0,ee=9007199254740991,Y=17976931348623157e292,ct=NaN,Ee=4294967295,dr=Ee-1,Vc=Ee>>>1,Fc=[["ary",Je],["bind",pe],["bindKey",Ae],["curry",fe],["curryRight",ue],["flip",pr],["partial",we],["partialRight",Et],["rearg",Te]],Qt="[object Arguments]",Gr="[object Array]",zc="[object AsyncFunction]",gr="[object Boolean]",vr="[object Date]",Bc="[object DOMException]",Wr="[object Error]",Qr="[object Function]",Ds="[object GeneratorFunction]",Ye="[object Map]",mr="[object Number]",Gc="[object Null]",ut="[object Object]",Ts="[object Promise]",Wc="[object Proxy]",yr="[object RegExp]",Ze="[object Set]",_r="[object String]",Kr="[object Symbol]",Qc="[object Undefined]",wr="[object WeakMap]",Kc="[object WeakSet]",Er="[object ArrayBuffer]",Kt="[object DataView]",Gi="[object Float32Array]",Wi="[object Float64Array]",Qi="[object Int8Array]",Ki="[object Int16Array]",Ji="[object Int32Array]",Yi="[object Uint8Array]",Zi="[object Uint8ClampedArray]",Xi="[object Uint16Array]",en="[object Uint32Array]",Jc=/\b__p \+= '';/g,Yc=/\b(__p \+=) '' \+/g,Zc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$s=/&(?:amp|lt|gt|quot|#39);/g,js=/[&<>"']/g,Xc=RegExp($s.source),eu=RegExp(js.source),tu=/<%-([\s\S]+?)%>/g,ru=/<%([\s\S]+?)%>/g,Ms=/<%=([\s\S]+?)%>/g,iu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nu=/^\w*$/,su=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tn=/[\\^$.*+?()[\]{}|]/g,ou=RegExp(tn.source),rn=/^\s+/,au=/\s/,cu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,uu=/\{\n\/\* \[wrapped with (.+)\] \*/,hu=/,? & /,lu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pu=/[()=,{}\[\]\/\s]/,fu=/\\(\\)?/g,du=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ls=/\w*$/,gu=/^[-+]0x[0-9a-f]+$/i,vu=/^0b[01]+$/i,mu=/^\[object .+?Constructor\]$/,yu=/^0o[0-7]+$/i,_u=/^(?:0|[1-9]\d*)$/,wu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jr=/($^)/,Eu=/['\n\r\u2028\u2029\\]/g,Yr="\\ud800-\\udfff",Iu="\\u0300-\\u036f",bu="\\ufe20-\\ufe2f",Pu="\\u20d0-\\u20ff",Hs=Iu+bu+Pu,Us="\\u2700-\\u27bf",ks="a-z\\xdf-\\xf6\\xf8-\\xff",Su="\\xac\\xb1\\xd7\\xf7",Ru="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Cu="\\u2000-\\u206f",Au=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Vs="A-Z\\xc0-\\xd6\\xd8-\\xde",Fs="\\ufe0e\\ufe0f",zs=Su+Ru+Cu+Au,nn="['’]",qu="["+Yr+"]",Bs="["+zs+"]",Zr="["+Hs+"]",Gs="\\d+",Ou="["+Us+"]",Ws="["+ks+"]",Qs="[^"+Yr+zs+Gs+Us+ks+Vs+"]",sn="\\ud83c[\\udffb-\\udfff]",Nu="(?:"+Zr+"|"+sn+")",Ks="[^"+Yr+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",an="[\\ud800-\\udbff][\\udc00-\\udfff]",Jt="["+Vs+"]",Js="\\u200d",Ys="(?:"+Ws+"|"+Qs+")",xu="(?:"+Jt+"|"+Qs+")",Zs="(?:"+nn+"(?:d|ll|m|re|s|t|ve))?",Xs="(?:"+nn+"(?:D|LL|M|RE|S|T|VE))?",eo=Nu+"?",to="["+Fs+"]?",Du="(?:"+Js+"(?:"+[Ks,on,an].join("|")+")"+to+eo+")*",Tu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$u="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ro=to+eo+Du,ju="(?:"+[Ou,on,an].join("|")+")"+ro,Mu="(?:"+[Ks+Zr+"?",Zr,on,an,qu].join("|")+")",Lu=RegExp(nn,"g"),Hu=RegExp(Zr,"g"),cn=RegExp(sn+"(?="+sn+")|"+Mu+ro,"g"),Uu=RegExp([Jt+"?"+Ws+"+"+Zs+"(?="+[Bs,Jt,"$"].join("|")+")",xu+"+"+Xs+"(?="+[Bs,Jt+Ys,"$"].join("|")+")",Jt+"?"+Ys+"+"+Zs,Jt+"+"+Xs,$u,Tu,Gs,ju].join("|"),"g"),ku=RegExp("["+Js+Yr+Hs+Fs+"]"),Vu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zu=-1,re={};re[Gi]=re[Wi]=re[Qi]=re[Ki]=re[Ji]=re[Yi]=re[Zi]=re[Xi]=re[en]=!0,re[Qt]=re[Gr]=re[Er]=re[gr]=re[Kt]=re[vr]=re[Wr]=re[Qr]=re[Ye]=re[mr]=re[ut]=re[yr]=re[Ze]=re[_r]=re[wr]=!1;var te={};te[Qt]=te[Gr]=te[Er]=te[Kt]=te[gr]=te[vr]=te[Gi]=te[Wi]=te[Qi]=te[Ki]=te[Ji]=te[Ye]=te[mr]=te[ut]=te[yr]=te[Ze]=te[_r]=te[Kr]=te[Yi]=te[Zi]=te[Xi]=te[en]=!0,te[Wr]=te[Qr]=te[wr]=!1;var Bu={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Gu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ku=parseFloat,Ju=parseInt,io=typeof Vr=="object"&&Vr&&Vr.Object===Object&&Vr,Yu=typeof self=="object"&&self&&self.Object===Object&&self,me=io||Yu||Function("return this")(),un=n&&!n.nodeType&&n,Tt=un&&!0&&P&&!P.nodeType&&P,no=Tt&&Tt.exports===un,hn=no&&io.process,Ve=function(){try{var d=Tt&&Tt.require&&Tt.require("util").types;return d||hn&&hn.binding&&hn.binding("util")}catch{}}(),so=Ve&&Ve.isArrayBuffer,oo=Ve&&Ve.isDate,ao=Ve&&Ve.isMap,co=Ve&&Ve.isRegExp,uo=Ve&&Ve.isSet,ho=Ve&&Ve.isTypedArray;function $e(d,_,v){switch(v.length){case 0:return d.call(_);case 1:return d.call(_,v[0]);case 2:return d.call(_,v[0],v[1]);case 3:return d.call(_,v[0],v[1],v[2])}return d.apply(_,v)}function Zu(d,_,v,A){for(var T=-1,Q=d==null?0:d.length;++T<Q;){var de=d[T];_(A,de,v(de),d)}return A}function Fe(d,_){for(var v=-1,A=d==null?0:d.length;++v<A&&_(d[v],v,d)!==!1;);return d}function Xu(d,_){for(var v=d==null?0:d.length;v--&&_(d[v],v,d)!==!1;);return d}function lo(d,_){for(var v=-1,A=d==null?0:d.length;++v<A;)if(!_(d[v],v,d))return!1;return!0}function It(d,_){for(var v=-1,A=d==null?0:d.length,T=0,Q=[];++v<A;){var de=d[v];_(de,v,d)&&(Q[T++]=de)}return Q}function Xr(d,_){var v=d==null?0:d.length;return!!v&&Yt(d,_,0)>-1}function ln(d,_,v){for(var A=-1,T=d==null?0:d.length;++A<T;)if(v(_,d[A]))return!0;return!1}function se(d,_){for(var v=-1,A=d==null?0:d.length,T=Array(A);++v<A;)T[v]=_(d[v],v,d);return T}function bt(d,_){for(var v=-1,A=_.length,T=d.length;++v<A;)d[T+v]=_[v];return d}function pn(d,_,v,A){var T=-1,Q=d==null?0:d.length;for(A&&Q&&(v=d[++T]);++T<Q;)v=_(v,d[T],T,d);return v}function eh(d,_,v,A){var T=d==null?0:d.length;for(A&&T&&(v=d[--T]);T--;)v=_(v,d[T],T,d);return v}function fn(d,_){for(var v=-1,A=d==null?0:d.length;++v<A;)if(_(d[v],v,d))return!0;return!1}var th=dn("length");function rh(d){return d.split("")}function ih(d){return d.match(lu)||[]}function po(d,_,v){var A;return v(d,function(T,Q,de){if(_(T,Q,de))return A=Q,!1}),A}function ei(d,_,v,A){for(var T=d.length,Q=v+(A?1:-1);A?Q--:++Q<T;)if(_(d[Q],Q,d))return Q;return-1}function Yt(d,_,v){return _===_?gh(d,_,v):ei(d,fo,v)}function nh(d,_,v,A){for(var T=v-1,Q=d.length;++T<Q;)if(A(d[T],_))return T;return-1}function fo(d){return d!==d}function go(d,_){var v=d==null?0:d.length;return v?vn(d,_)/v:ct}function dn(d){return function(_){return _==null?i:_[d]}}function gn(d){return function(_){return d==null?i:d[_]}}function vo(d,_,v,A,T){return T(d,function(Q,de,X){v=A?(A=!1,Q):_(v,Q,de,X)}),v}function sh(d,_){var v=d.length;for(d.sort(_);v--;)d[v]=d[v].value;return d}function vn(d,_){for(var v,A=-1,T=d.length;++A<T;){var Q=_(d[A]);Q!==i&&(v=v===i?Q:v+Q)}return v}function mn(d,_){for(var v=-1,A=Array(d);++v<d;)A[v]=_(v);return A}function oh(d,_){return se(_,function(v){return[v,d[v]]})}function mo(d){return d&&d.slice(0,Eo(d)+1).replace(rn,"")}function je(d){return function(_){return d(_)}}function yn(d,_){return se(_,function(v){return d[v]})}function Ir(d,_){return d.has(_)}function yo(d,_){for(var v=-1,A=d.length;++v<A&&Yt(_,d[v],0)>-1;);return v}function _o(d,_){for(var v=d.length;v--&&Yt(_,d[v],0)>-1;);return v}function ah(d,_){for(var v=d.length,A=0;v--;)d[v]===_&&++A;return A}var ch=gn(Bu),uh=gn(Gu);function hh(d){return"\\"+Qu[d]}function lh(d,_){return d==null?i:d[_]}function Zt(d){return ku.test(d)}function ph(d){return Vu.test(d)}function fh(d){for(var _,v=[];!(_=d.next()).done;)v.push(_.value);return v}function _n(d){var _=-1,v=Array(d.size);return d.forEach(function(A,T){v[++_]=[T,A]}),v}function wo(d,_){return function(v){return d(_(v))}}function Pt(d,_){for(var v=-1,A=d.length,T=0,Q=[];++v<A;){var de=d[v];(de===_||de===j)&&(d[v]=j,Q[T++]=v)}return Q}function ti(d){var _=-1,v=Array(d.size);return d.forEach(function(A){v[++_]=A}),v}function dh(d){var _=-1,v=Array(d.size);return d.forEach(function(A){v[++_]=[A,A]}),v}function gh(d,_,v){for(var A=v-1,T=d.length;++A<T;)if(d[A]===_)return A;return-1}function vh(d,_,v){for(var A=v+1;A--;)if(d[A]===_)return A;return A}function Xt(d){return Zt(d)?yh(d):th(d)}function Xe(d){return Zt(d)?_h(d):rh(d)}function Eo(d){for(var _=d.length;_--&&au.test(d.charAt(_)););return _}var mh=gn(Wu);function yh(d){for(var _=cn.lastIndex=0;cn.test(d);)++_;return _}function _h(d){return d.match(cn)||[]}function wh(d){return d.match(Uu)||[]}var Eh=function d(_){_=_==null?me:er.defaults(me.Object(),_,er.pick(me,Fu));var v=_.Array,A=_.Date,T=_.Error,Q=_.Function,de=_.Math,X=_.Object,wn=_.RegExp,Ih=_.String,ze=_.TypeError,ri=v.prototype,bh=Q.prototype,tr=X.prototype,ii=_["__core-js_shared__"],ni=bh.toString,Z=tr.hasOwnProperty,Ph=0,Io=function(){var e=/[^.]+$/.exec(ii&&ii.keys&&ii.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),si=tr.toString,Sh=ni.call(X),Rh=me._,Ch=wn("^"+ni.call(Z).replace(tn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oi=no?_.Buffer:i,St=_.Symbol,ai=_.Uint8Array,bo=oi?oi.allocUnsafe:i,ci=wo(X.getPrototypeOf,X),Po=X.create,So=tr.propertyIsEnumerable,ui=ri.splice,Ro=St?St.isConcatSpreadable:i,br=St?St.iterator:i,$t=St?St.toStringTag:i,hi=function(){try{var e=Ut(X,"defineProperty");return e({},"",{}),e}catch{}}(),Ah=_.clearTimeout!==me.clearTimeout&&_.clearTimeout,qh=A&&A.now!==me.Date.now&&A.now,Oh=_.setTimeout!==me.setTimeout&&_.setTimeout,li=de.ceil,pi=de.floor,En=X.getOwnPropertySymbols,Nh=oi?oi.isBuffer:i,Co=_.isFinite,xh=ri.join,Dh=wo(X.keys,X),ge=de.max,Ie=de.min,Th=A.now,$h=_.parseInt,Ao=de.random,jh=ri.reverse,In=Ut(_,"DataView"),Pr=Ut(_,"Map"),bn=Ut(_,"Promise"),rr=Ut(_,"Set"),Sr=Ut(_,"WeakMap"),Rr=Ut(X,"create"),fi=Sr&&new Sr,ir={},Mh=kt(In),Lh=kt(Pr),Hh=kt(bn),Uh=kt(rr),kh=kt(Sr),di=St?St.prototype:i,Cr=di?di.valueOf:i,qo=di?di.toString:i;function u(e){if(ce(e)&&!$(e)&&!(e instanceof G)){if(e instanceof Be)return e;if(Z.call(e,"__wrapped__"))return Oa(e)}return new Be(e)}var nr=function(){function e(){}return function(t){if(!ae(t))return{};if(Po)return Po(t);e.prototype=t;var r=new e;return e.prototype=i,r}}();function gi(){}function Be(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}u.templateSettings={escape:tu,evaluate:ru,interpolate:Ms,variable:"",imports:{_:u}},u.prototype=gi.prototype,u.prototype.constructor=u,Be.prototype=nr(gi.prototype),Be.prototype.constructor=Be;function G(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ee,this.__views__=[]}function Vh(){var e=new G(this.__wrapped__);return e.__actions__=qe(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=qe(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=qe(this.__views__),e}function Fh(){if(this.__filtered__){var e=new G(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function zh(){var e=this.__wrapped__.value(),t=this.__dir__,r=$(e),s=t<0,a=r?e.length:0,h=rp(0,a,this.__views__),l=h.start,p=h.end,g=p-l,w=s?p:l-1,E=this.__iteratees__,b=E.length,C=0,O=Ie(g,this.__takeCount__);if(!r||!s&&a==g&&O==g)return Xo(e,this.__actions__);var x=[];e:for(;g--&&C<O;){w+=t;for(var k=-1,D=e[w];++k<b;){var B=E[k],W=B.iteratee,He=B.type,Re=W(D);if(He==S)D=Re;else if(!Re){if(He==m)continue e;break e}}x[C++]=D}return x}G.prototype=nr(gi.prototype),G.prototype.constructor=G;function jt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Bh(){this.__data__=Rr?Rr(null):{},this.size=0}function Gh(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Wh(e){var t=this.__data__;if(Rr){var r=t[e];return r===R?i:r}return Z.call(t,e)?t[e]:i}function Qh(e){var t=this.__data__;return Rr?t[e]!==i:Z.call(t,e)}function Kh(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Rr&&t===i?R:t,this}jt.prototype.clear=Bh,jt.prototype.delete=Gh,jt.prototype.get=Wh,jt.prototype.has=Qh,jt.prototype.set=Kh;function ht(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function Jh(){this.__data__=[],this.size=0}function Yh(e){var t=this.__data__,r=vi(t,e);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():ui.call(t,r,1),--this.size,!0}function Zh(e){var t=this.__data__,r=vi(t,e);return r<0?i:t[r][1]}function Xh(e){return vi(this.__data__,e)>-1}function el(e,t){var r=this.__data__,s=vi(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}ht.prototype.clear=Jh,ht.prototype.delete=Yh,ht.prototype.get=Zh,ht.prototype.has=Xh,ht.prototype.set=el;function lt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}function tl(){this.size=0,this.__data__={hash:new jt,map:new(Pr||ht),string:new jt}}function rl(e){var t=Ai(this,e).delete(e);return this.size-=t?1:0,t}function il(e){return Ai(this,e).get(e)}function nl(e){return Ai(this,e).has(e)}function sl(e,t){var r=Ai(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}lt.prototype.clear=tl,lt.prototype.delete=rl,lt.prototype.get=il,lt.prototype.has=nl,lt.prototype.set=sl;function Mt(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new lt;++t<r;)this.add(e[t])}function ol(e){return this.__data__.set(e,R),this}function al(e){return this.__data__.has(e)}Mt.prototype.add=Mt.prototype.push=ol,Mt.prototype.has=al;function et(e){var t=this.__data__=new ht(e);this.size=t.size}function cl(){this.__data__=new ht,this.size=0}function ul(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function hl(e){return this.__data__.get(e)}function ll(e){return this.__data__.has(e)}function pl(e,t){var r=this.__data__;if(r instanceof ht){var s=r.__data__;if(!Pr||s.length<c-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new lt(s)}return r.set(e,t),this.size=r.size,this}et.prototype.clear=cl,et.prototype.delete=ul,et.prototype.get=hl,et.prototype.has=ll,et.prototype.set=pl;function Oo(e,t){var r=$(e),s=!r&&Vt(e),a=!r&&!s&&Ot(e),h=!r&&!s&&!a&&cr(e),l=r||s||a||h,p=l?mn(e.length,Ih):[],g=p.length;for(var w in e)(t||Z.call(e,w))&&!(l&&(w=="length"||a&&(w=="offset"||w=="parent")||h&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||gt(w,g)))&&p.push(w);return p}function No(e){var t=e.length;return t?e[Tn(0,t-1)]:i}function fl(e,t){return qi(qe(e),Lt(t,0,e.length))}function dl(e){return qi(qe(e))}function Pn(e,t,r){(r!==i&&!tt(e[t],r)||r===i&&!(t in e))&&pt(e,t,r)}function Ar(e,t,r){var s=e[t];(!(Z.call(e,t)&&tt(s,r))||r===i&&!(t in e))&&pt(e,t,r)}function vi(e,t){for(var r=e.length;r--;)if(tt(e[r][0],t))return r;return-1}function gl(e,t,r,s){return Rt(e,function(a,h,l){t(s,a,r(a),l)}),s}function xo(e,t){return e&&st(t,ve(t),e)}function vl(e,t){return e&&st(t,Ne(t),e)}function pt(e,t,r){t=="__proto__"&&hi?hi(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Sn(e,t){for(var r=-1,s=t.length,a=v(s),h=e==null;++r<s;)a[r]=h?i:ss(e,t[r]);return a}function Lt(e,t,r){return e===e&&(r!==i&&(e=e<=r?e:r),t!==i&&(e=e>=t?e:t)),e}function Ge(e,t,r,s,a,h){var l,p=t&M,g=t&H,w=t&J;if(r&&(l=a?r(e,s,a,h):r(e)),l!==i)return l;if(!ae(e))return e;var E=$(e);if(E){if(l=np(e),!p)return qe(e,l)}else{var b=be(e),C=b==Qr||b==Ds;if(Ot(e))return ra(e,p);if(b==ut||b==Qt||C&&!a){if(l=g||C?{}:Ea(e),!p)return g?Wl(e,vl(l,e)):Gl(e,xo(l,e))}else{if(!te[b])return a?e:{};l=sp(e,b,p)}}h||(h=new et);var O=h.get(e);if(O)return O;h.set(e,l),Ja(e)?e.forEach(function(D){l.add(Ge(D,t,r,D,e,h))}):Qa(e)&&e.forEach(function(D,B){l.set(B,Ge(D,t,r,B,e,h))});var x=w?g?Bn:zn:g?Ne:ve,k=E?i:x(e);return Fe(k||e,function(D,B){k&&(B=D,D=e[B]),Ar(l,B,Ge(D,t,r,B,e,h))}),l}function ml(e){var t=ve(e);return function(r){return Do(r,e,t)}}function Do(e,t,r){var s=r.length;if(e==null)return!s;for(e=X(e);s--;){var a=r[s],h=t[a],l=e[a];if(l===i&&!(a in e)||!h(l))return!1}return!0}function To(e,t,r){if(typeof e!="function")throw new ze(y);return $r(function(){e.apply(i,r)},t)}function qr(e,t,r,s){var a=-1,h=Xr,l=!0,p=e.length,g=[],w=t.length;if(!p)return g;r&&(t=se(t,je(r))),s?(h=ln,l=!1):t.length>=c&&(h=Ir,l=!1,t=new Mt(t));e:for(;++a<p;){var E=e[a],b=r==null?E:r(E);if(E=s||E!==0?E:0,l&&b===b){for(var C=w;C--;)if(t[C]===b)continue e;g.push(E)}else h(t,b,s)||g.push(E)}return g}var Rt=aa(nt),$o=aa(Cn,!0);function yl(e,t){var r=!0;return Rt(e,function(s,a,h){return r=!!t(s,a,h),r}),r}function mi(e,t,r){for(var s=-1,a=e.length;++s<a;){var h=e[s],l=t(h);if(l!=null&&(p===i?l===l&&!Le(l):r(l,p)))var p=l,g=h}return g}function _l(e,t,r,s){var a=e.length;for(r=L(r),r<0&&(r=-r>a?0:a+r),s=s===i||s>a?a:L(s),s<0&&(s+=a),s=r>s?0:Za(s);r<s;)e[r++]=t;return e}function jo(e,t){var r=[];return Rt(e,function(s,a,h){t(s,a,h)&&r.push(s)}),r}function ye(e,t,r,s,a){var h=-1,l=e.length;for(r||(r=ap),a||(a=[]);++h<l;){var p=e[h];t>0&&r(p)?t>1?ye(p,t-1,r,s,a):bt(a,p):s||(a[a.length]=p)}return a}var Rn=ca(),Mo=ca(!0);function nt(e,t){return e&&Rn(e,t,ve)}function Cn(e,t){return e&&Mo(e,t,ve)}function yi(e,t){return It(t,function(r){return vt(e[r])})}function Ht(e,t){t=At(t,e);for(var r=0,s=t.length;e!=null&&r<s;)e=e[ot(t[r++])];return r&&r==s?e:i}function Lo(e,t,r){var s=t(e);return $(e)?s:bt(s,r(e))}function Pe(e){return e==null?e===i?Qc:Gc:$t&&$t in X(e)?tp(e):dp(e)}function An(e,t){return e>t}function wl(e,t){return e!=null&&Z.call(e,t)}function El(e,t){return e!=null&&t in X(e)}function Il(e,t,r){return e>=Ie(t,r)&&e<ge(t,r)}function qn(e,t,r){for(var s=r?ln:Xr,a=e[0].length,h=e.length,l=h,p=v(h),g=1/0,w=[];l--;){var E=e[l];l&&t&&(E=se(E,je(t))),g=Ie(E.length,g),p[l]=!r&&(t||a>=120&&E.length>=120)?new Mt(l&&E):i}E=e[0];var b=-1,C=p[0];e:for(;++b<a&&w.length<g;){var O=E[b],x=t?t(O):O;if(O=r||O!==0?O:0,!(C?Ir(C,x):s(w,x,r))){for(l=h;--l;){var k=p[l];if(!(k?Ir(k,x):s(e[l],x,r)))continue e}C&&C.push(x),w.push(O)}}return w}function bl(e,t,r,s){return nt(e,function(a,h,l){t(s,r(a),h,l)}),s}function Or(e,t,r){t=At(t,e),e=Sa(e,t);var s=e==null?e:e[ot(Qe(t))];return s==null?i:$e(s,e,r)}function Ho(e){return ce(e)&&Pe(e)==Qt}function Pl(e){return ce(e)&&Pe(e)==Er}function Sl(e){return ce(e)&&Pe(e)==vr}function Nr(e,t,r,s,a){return e===t?!0:e==null||t==null||!ce(e)&&!ce(t)?e!==e&&t!==t:Rl(e,t,r,s,Nr,a)}function Rl(e,t,r,s,a,h){var l=$(e),p=$(t),g=l?Gr:be(e),w=p?Gr:be(t);g=g==Qt?ut:g,w=w==Qt?ut:w;var E=g==ut,b=w==ut,C=g==w;if(C&&Ot(e)){if(!Ot(t))return!1;l=!0,E=!1}if(C&&!E)return h||(h=new et),l||cr(e)?ya(e,t,r,s,a,h):Xl(e,t,g,r,s,a,h);if(!(r&F)){var O=E&&Z.call(e,"__wrapped__"),x=b&&Z.call(t,"__wrapped__");if(O||x){var k=O?e.value():e,D=x?t.value():t;return h||(h=new et),a(k,D,r,s,h)}}return C?(h||(h=new et),ep(e,t,r,s,a,h)):!1}function Cl(e){return ce(e)&&be(e)==Ye}function On(e,t,r,s){var a=r.length,h=a,l=!s;if(e==null)return!h;for(e=X(e);a--;){var p=r[a];if(l&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++a<h;){p=r[a];var g=p[0],w=e[g],E=p[1];if(l&&p[2]){if(w===i&&!(g in e))return!1}else{var b=new et;if(s)var C=s(w,E,g,e,t,b);if(!(C===i?Nr(E,w,F|Ce,s,b):C))return!1}}return!0}function Uo(e){if(!ae(e)||up(e))return!1;var t=vt(e)?Ch:mu;return t.test(kt(e))}function Al(e){return ce(e)&&Pe(e)==yr}function ql(e){return ce(e)&&be(e)==Ze}function Ol(e){return ce(e)&&$i(e.length)&&!!re[Pe(e)]}function ko(e){return typeof e=="function"?e:e==null?xe:typeof e=="object"?$(e)?zo(e[0],e[1]):Fo(e):uc(e)}function Nn(e){if(!Tr(e))return Dh(e);var t=[];for(var r in X(e))Z.call(e,r)&&r!="constructor"&&t.push(r);return t}function Nl(e){if(!ae(e))return fp(e);var t=Tr(e),r=[];for(var s in e)s=="constructor"&&(t||!Z.call(e,s))||r.push(s);return r}function xn(e,t){return e<t}function Vo(e,t){var r=-1,s=Oe(e)?v(e.length):[];return Rt(e,function(a,h,l){s[++r]=t(a,h,l)}),s}function Fo(e){var t=Wn(e);return t.length==1&&t[0][2]?ba(t[0][0],t[0][1]):function(r){return r===e||On(r,e,t)}}function zo(e,t){return Kn(e)&&Ia(t)?ba(ot(e),t):function(r){var s=ss(r,e);return s===i&&s===t?os(r,e):Nr(t,s,F|Ce)}}function _i(e,t,r,s,a){e!==t&&Rn(t,function(h,l){if(a||(a=new et),ae(h))xl(e,t,l,r,_i,s,a);else{var p=s?s(Yn(e,l),h,l+"",e,t,a):i;p===i&&(p=h),Pn(e,l,p)}},Ne)}function xl(e,t,r,s,a,h,l){var p=Yn(e,r),g=Yn(t,r),w=l.get(g);if(w){Pn(e,r,w);return}var E=h?h(p,g,r+"",e,t,l):i,b=E===i;if(b){var C=$(g),O=!C&&Ot(g),x=!C&&!O&&cr(g);E=g,C||O||x?$(p)?E=p:he(p)?E=qe(p):O?(b=!1,E=ra(g,!0)):x?(b=!1,E=ia(g,!0)):E=[]:jr(g)||Vt(g)?(E=p,Vt(p)?E=Xa(p):(!ae(p)||vt(p))&&(E=Ea(g))):b=!1}b&&(l.set(g,E),a(E,g,s,h,l),l.delete(g)),Pn(e,r,E)}function Bo(e,t){var r=e.length;if(r)return t+=t<0?r:0,gt(t,r)?e[t]:i}function Go(e,t,r){t.length?t=se(t,function(h){return $(h)?function(l){return Ht(l,h.length===1?h[0]:h)}:h}):t=[xe];var s=-1;t=se(t,je(N()));var a=Vo(e,function(h,l,p){var g=se(t,function(w){return w(h)});return{criteria:g,index:++s,value:h}});return sh(a,function(h,l){return Bl(h,l,r)})}function Dl(e,t){return Wo(e,t,function(r,s){return os(e,s)})}function Wo(e,t,r){for(var s=-1,a=t.length,h={};++s<a;){var l=t[s],p=Ht(e,l);r(p,l)&&xr(h,At(l,e),p)}return h}function Tl(e){return function(t){return Ht(t,e)}}function Dn(e,t,r,s){var a=s?nh:Yt,h=-1,l=t.length,p=e;for(e===t&&(t=qe(t)),r&&(p=se(e,je(r)));++h<l;)for(var g=0,w=t[h],E=r?r(w):w;(g=a(p,E,g,s))>-1;)p!==e&&ui.call(p,g,1),ui.call(e,g,1);return e}function Qo(e,t){for(var r=e?t.length:0,s=r-1;r--;){var a=t[r];if(r==s||a!==h){var h=a;gt(a)?ui.call(e,a,1):Mn(e,a)}}return e}function Tn(e,t){return e+pi(Ao()*(t-e+1))}function $l(e,t,r,s){for(var a=-1,h=ge(li((t-e)/(r||1)),0),l=v(h);h--;)l[s?h:++a]=e,e+=r;return l}function $n(e,t){var r="";if(!e||t<1||t>ee)return r;do t%2&&(r+=e),t=pi(t/2),t&&(e+=e);while(t);return r}function z(e,t){return Zn(Pa(e,t,xe),e+"")}function jl(e){return No(ur(e))}function Ml(e,t){var r=ur(e);return qi(r,Lt(t,0,r.length))}function xr(e,t,r,s){if(!ae(e))return e;t=At(t,e);for(var a=-1,h=t.length,l=h-1,p=e;p!=null&&++a<h;){var g=ot(t[a]),w=r;if(g==="__proto__"||g==="constructor"||g==="prototype")return e;if(a!=l){var E=p[g];w=s?s(E,g,p):i,w===i&&(w=ae(E)?E:gt(t[a+1])?[]:{})}Ar(p,g,w),p=p[g]}return e}var Ko=fi?function(e,t){return fi.set(e,t),e}:xe,Ll=hi?function(e,t){return hi(e,"toString",{configurable:!0,enumerable:!1,value:cs(t),writable:!0})}:xe;function Hl(e){return qi(ur(e))}function We(e,t,r){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var h=v(a);++s<a;)h[s]=e[s+t];return h}function Ul(e,t){var r;return Rt(e,function(s,a,h){return r=t(s,a,h),!r}),!!r}function wi(e,t,r){var s=0,a=e==null?s:e.length;if(typeof t=="number"&&t===t&&a<=Vc){for(;s<a;){var h=s+a>>>1,l=e[h];l!==null&&!Le(l)&&(r?l<=t:l<t)?s=h+1:a=h}return a}return jn(e,t,xe,r)}function jn(e,t,r,s){var a=0,h=e==null?0:e.length;if(h===0)return 0;t=r(t);for(var l=t!==t,p=t===null,g=Le(t),w=t===i;a<h;){var E=pi((a+h)/2),b=r(e[E]),C=b!==i,O=b===null,x=b===b,k=Le(b);if(l)var D=s||x;else w?D=x&&(s||C):p?D=x&&C&&(s||!O):g?D=x&&C&&!O&&(s||!k):O||k?D=!1:D=s?b<=t:b<t;D?a=E+1:h=E}return Ie(h,dr)}function Jo(e,t){for(var r=-1,s=e.length,a=0,h=[];++r<s;){var l=e[r],p=t?t(l):l;if(!r||!tt(p,g)){var g=p;h[a++]=l===0?0:l}}return h}function Yo(e){return typeof e=="number"?e:Le(e)?ct:+e}function Me(e){if(typeof e=="string")return e;if($(e))return se(e,Me)+"";if(Le(e))return qo?qo.call(e):"";var t=e+"";return t=="0"&&1/e==-ne?"-0":t}function Ct(e,t,r){var s=-1,a=Xr,h=e.length,l=!0,p=[],g=p;if(r)l=!1,a=ln;else if(h>=c){var w=t?null:Yl(e);if(w)return ti(w);l=!1,a=Ir,g=new Mt}else g=t?[]:p;e:for(;++s<h;){var E=e[s],b=t?t(E):E;if(E=r||E!==0?E:0,l&&b===b){for(var C=g.length;C--;)if(g[C]===b)continue e;t&&g.push(b),p.push(E)}else a(g,b,r)||(g!==p&&g.push(b),p.push(E))}return p}function Mn(e,t){return t=At(t,e),e=Sa(e,t),e==null||delete e[ot(Qe(t))]}function Zo(e,t,r,s){return xr(e,t,r(Ht(e,t)),s)}function Ei(e,t,r,s){for(var a=e.length,h=s?a:-1;(s?h--:++h<a)&&t(e[h],h,e););return r?We(e,s?0:h,s?h+1:a):We(e,s?h+1:0,s?a:h)}function Xo(e,t){var r=e;return r instanceof G&&(r=r.value()),pn(t,function(s,a){return a.func.apply(a.thisArg,bt([s],a.args))},r)}function Ln(e,t,r){var s=e.length;if(s<2)return s?Ct(e[0]):[];for(var a=-1,h=v(s);++a<s;)for(var l=e[a],p=-1;++p<s;)p!=a&&(h[a]=qr(h[a]||l,e[p],t,r));return Ct(ye(h,1),t,r)}function ea(e,t,r){for(var s=-1,a=e.length,h=t.length,l={};++s<a;){var p=s<h?t[s]:i;r(l,e[s],p)}return l}function Hn(e){return he(e)?e:[]}function Un(e){return typeof e=="function"?e:xe}function At(e,t){return $(e)?e:Kn(e,t)?[e]:qa(K(e))}var kl=z;function qt(e,t,r){var s=e.length;return r=r===i?s:r,!t&&r>=s?e:We(e,t,r)}var ta=Ah||function(e){return me.clearTimeout(e)};function ra(e,t){if(t)return e.slice();var r=e.length,s=bo?bo(r):new e.constructor(r);return e.copy(s),s}function kn(e){var t=new e.constructor(e.byteLength);return new ai(t).set(new ai(e)),t}function Vl(e,t){var r=t?kn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function Fl(e){var t=new e.constructor(e.source,Ls.exec(e));return t.lastIndex=e.lastIndex,t}function zl(e){return Cr?X(Cr.call(e)):{}}function ia(e,t){var r=t?kn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function na(e,t){if(e!==t){var r=e!==i,s=e===null,a=e===e,h=Le(e),l=t!==i,p=t===null,g=t===t,w=Le(t);if(!p&&!w&&!h&&e>t||h&&l&&g&&!p&&!w||s&&l&&g||!r&&g||!a)return 1;if(!s&&!h&&!w&&e<t||w&&r&&a&&!s&&!h||p&&r&&a||!l&&a||!g)return-1}return 0}function Bl(e,t,r){for(var s=-1,a=e.criteria,h=t.criteria,l=a.length,p=r.length;++s<l;){var g=na(a[s],h[s]);if(g){if(s>=p)return g;var w=r[s];return g*(w=="desc"?-1:1)}}return e.index-t.index}function sa(e,t,r,s){for(var a=-1,h=e.length,l=r.length,p=-1,g=t.length,w=ge(h-l,0),E=v(g+w),b=!s;++p<g;)E[p]=t[p];for(;++a<l;)(b||a<h)&&(E[r[a]]=e[a]);for(;w--;)E[p++]=e[a++];return E}function oa(e,t,r,s){for(var a=-1,h=e.length,l=-1,p=r.length,g=-1,w=t.length,E=ge(h-p,0),b=v(E+w),C=!s;++a<E;)b[a]=e[a];for(var O=a;++g<w;)b[O+g]=t[g];for(;++l<p;)(C||a<h)&&(b[O+r[l]]=e[a++]);return b}function qe(e,t){var r=-1,s=e.length;for(t||(t=v(s));++r<s;)t[r]=e[r];return t}function st(e,t,r,s){var a=!r;r||(r={});for(var h=-1,l=t.length;++h<l;){var p=t[h],g=s?s(r[p],e[p],p,r,e):i;g===i&&(g=e[p]),a?pt(r,p,g):Ar(r,p,g)}return r}function Gl(e,t){return st(e,Qn(e),t)}function Wl(e,t){return st(e,_a(e),t)}function Ii(e,t){return function(r,s){var a=$(r)?Zu:gl,h=t?t():{};return a(r,e,N(s,2),h)}}function sr(e){return z(function(t,r){var s=-1,a=r.length,h=a>1?r[a-1]:i,l=a>2?r[2]:i;for(h=e.length>3&&typeof h=="function"?(a--,h):i,l&&Se(r[0],r[1],l)&&(h=a<3?i:h,a=1),t=X(t);++s<a;){var p=r[s];p&&e(t,p,s,h)}return t})}function aa(e,t){return function(r,s){if(r==null)return r;if(!Oe(r))return e(r,s);for(var a=r.length,h=t?a:-1,l=X(r);(t?h--:++h<a)&&s(l[h],h,l)!==!1;);return r}}function ca(e){return function(t,r,s){for(var a=-1,h=X(t),l=s(t),p=l.length;p--;){var g=l[e?p:++a];if(r(h[g],g,h)===!1)break}return t}}function Ql(e,t,r){var s=t&pe,a=Dr(e);function h(){var l=this&&this!==me&&this instanceof h?a:e;return l.apply(s?r:this,arguments)}return h}function ua(e){return function(t){t=K(t);var r=Zt(t)?Xe(t):i,s=r?r[0]:t.charAt(0),a=r?qt(r,1).join(""):t.slice(1);return s[e]()+a}}function or(e){return function(t){return pn(ac(oc(t).replace(Lu,"")),e,"")}}function Dr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=nr(e.prototype),s=e.apply(r,t);return ae(s)?s:r}}function Kl(e,t,r){var s=Dr(e);function a(){for(var h=arguments.length,l=v(h),p=h,g=ar(a);p--;)l[p]=arguments[p];var w=h<3&&l[0]!==g&&l[h-1]!==g?[]:Pt(l,g);if(h-=w.length,h<r)return da(e,t,bi,a.placeholder,i,l,w,i,i,r-h);var E=this&&this!==me&&this instanceof a?s:e;return $e(E,this,l)}return a}function ha(e){return function(t,r,s){var a=X(t);if(!Oe(t)){var h=N(r,3);t=ve(t),r=function(p){return h(a[p],p,a)}}var l=e(t,r,s);return l>-1?a[h?t[l]:l]:i}}function la(e){return dt(function(t){var r=t.length,s=r,a=Be.prototype.thru;for(e&&t.reverse();s--;){var h=t[s];if(typeof h!="function")throw new ze(y);if(a&&!l&&Ci(h)=="wrapper")var l=new Be([],!0)}for(s=l?s:r;++s<r;){h=t[s];var p=Ci(h),g=p=="wrapper"?Gn(h):i;g&&Jn(g[0])&&g[1]==(Je|fe|we|Te)&&!g[4].length&&g[9]==1?l=l[Ci(g[0])].apply(l,g[3]):l=h.length==1&&Jn(h)?l[p]():l.thru(h)}return function(){var w=arguments,E=w[0];if(l&&w.length==1&&$(E))return l.plant(E).value();for(var b=0,C=r?t[b].apply(this,w):E;++b<r;)C=t[b].call(this,C);return C}})}function bi(e,t,r,s,a,h,l,p,g,w){var E=t&Je,b=t&pe,C=t&Ae,O=t&(fe|ue),x=t&pr,k=C?i:Dr(e);function D(){for(var B=arguments.length,W=v(B),He=B;He--;)W[He]=arguments[He];if(O)var Re=ar(D),Ue=ah(W,Re);if(s&&(W=sa(W,s,a,O)),h&&(W=oa(W,h,l,O)),B-=Ue,O&&B<w){var le=Pt(W,Re);return da(e,t,bi,D.placeholder,r,W,le,p,g,w-B)}var rt=b?r:this,yt=C?rt[e]:e;return B=W.length,p?W=gp(W,p):x&&B>1&&W.reverse(),E&&g<B&&(W.length=g),this&&this!==me&&this instanceof D&&(yt=k||Dr(yt)),yt.apply(rt,W)}return D}function pa(e,t){return function(r,s){return bl(r,e,t(s),{})}}function Pi(e,t){return function(r,s){var a;if(r===i&&s===i)return t;if(r!==i&&(a=r),s!==i){if(a===i)return s;typeof r=="string"||typeof s=="string"?(r=Me(r),s=Me(s)):(r=Yo(r),s=Yo(s)),a=e(r,s)}return a}}function Vn(e){return dt(function(t){return t=se(t,je(N())),z(function(r){var s=this;return e(t,function(a){return $e(a,s,r)})})})}function Si(e,t){t=t===i?" ":Me(t);var r=t.length;if(r<2)return r?$n(t,e):t;var s=$n(t,li(e/Xt(t)));return Zt(t)?qt(Xe(s),0,e).join(""):s.slice(0,e)}function Jl(e,t,r,s){var a=t&pe,h=Dr(e);function l(){for(var p=-1,g=arguments.length,w=-1,E=s.length,b=v(E+g),C=this&&this!==me&&this instanceof l?h:e;++w<E;)b[w]=s[w];for(;g--;)b[w++]=arguments[++p];return $e(C,a?r:this,b)}return l}function fa(e){return function(t,r,s){return s&&typeof s!="number"&&Se(t,r,s)&&(r=s=i),t=mt(t),r===i?(r=t,t=0):r=mt(r),s=s===i?t<r?1:-1:mt(s),$l(t,r,s,e)}}function Ri(e){return function(t,r){return typeof t=="string"&&typeof r=="string"||(t=Ke(t),r=Ke(r)),e(t,r)}}function da(e,t,r,s,a,h,l,p,g,w){var E=t&fe,b=E?l:i,C=E?i:l,O=E?h:i,x=E?i:h;t|=E?we:Et,t&=~(E?Et:we),t&Wt||(t&=~(pe|Ae));var k=[e,t,a,O,b,x,C,p,g,w],D=r.apply(i,k);return Jn(e)&&Ra(D,k),D.placeholder=s,Ca(D,e,t)}function Fn(e){var t=de[e];return function(r,s){if(r=Ke(r),s=s==null?0:Ie(L(s),292),s&&Co(r)){var a=(K(r)+"e").split("e"),h=t(a[0]+"e"+(+a[1]+s));return a=(K(h)+"e").split("e"),+(a[0]+"e"+(+a[1]-s))}return t(r)}}var Yl=rr&&1/ti(new rr([,-0]))[1]==ne?function(e){return new rr(e)}:ls;function ga(e){return function(t){var r=be(t);return r==Ye?_n(t):r==Ze?dh(t):oh(t,e(t))}}function ft(e,t,r,s,a,h,l,p){var g=t&Ae;if(!g&&typeof e!="function")throw new ze(y);var w=s?s.length:0;if(w||(t&=~(we|Et),s=a=i),l=l===i?l:ge(L(l),0),p=p===i?p:L(p),w-=a?a.length:0,t&Et){var E=s,b=a;s=a=i}var C=g?i:Gn(e),O=[e,t,r,s,a,E,b,h,l,p];if(C&&pp(O,C),e=O[0],t=O[1],r=O[2],s=O[3],a=O[4],p=O[9]=O[9]===i?g?0:e.length:ge(O[9]-w,0),!p&&t&(fe|ue)&&(t&=~(fe|ue)),!t||t==pe)var x=Ql(e,t,r);else t==fe||t==ue?x=Kl(e,t,p):(t==we||t==(pe|we))&&!a.length?x=Jl(e,t,r,s):x=bi.apply(i,O);var k=C?Ko:Ra;return Ca(k(x,O),e,t)}function va(e,t,r,s){return e===i||tt(e,tr[r])&&!Z.call(s,r)?t:e}function ma(e,t,r,s,a,h){return ae(e)&&ae(t)&&(h.set(t,e),_i(e,t,i,ma,h),h.delete(t)),e}function Zl(e){return jr(e)?i:e}function ya(e,t,r,s,a,h){var l=r&F,p=e.length,g=t.length;if(p!=g&&!(l&&g>p))return!1;var w=h.get(e),E=h.get(t);if(w&&E)return w==t&&E==e;var b=-1,C=!0,O=r&Ce?new Mt:i;for(h.set(e,t),h.set(t,e);++b<p;){var x=e[b],k=t[b];if(s)var D=l?s(k,x,b,t,e,h):s(x,k,b,e,t,h);if(D!==i){if(D)continue;C=!1;break}if(O){if(!fn(t,function(B,W){if(!Ir(O,W)&&(x===B||a(x,B,r,s,h)))return O.push(W)})){C=!1;break}}else if(!(x===k||a(x,k,r,s,h))){C=!1;break}}return h.delete(e),h.delete(t),C}function Xl(e,t,r,s,a,h,l){switch(r){case Kt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Er:return!(e.byteLength!=t.byteLength||!h(new ai(e),new ai(t)));case gr:case vr:case mr:return tt(+e,+t);case Wr:return e.name==t.name&&e.message==t.message;case yr:case _r:return e==t+"";case Ye:var p=_n;case Ze:var g=s&F;if(p||(p=ti),e.size!=t.size&&!g)return!1;var w=l.get(e);if(w)return w==t;s|=Ce,l.set(e,t);var E=ya(p(e),p(t),s,a,h,l);return l.delete(e),E;case Kr:if(Cr)return Cr.call(e)==Cr.call(t)}return!1}function ep(e,t,r,s,a,h){var l=r&F,p=zn(e),g=p.length,w=zn(t),E=w.length;if(g!=E&&!l)return!1;for(var b=g;b--;){var C=p[b];if(!(l?C in t:Z.call(t,C)))return!1}var O=h.get(e),x=h.get(t);if(O&&x)return O==t&&x==e;var k=!0;h.set(e,t),h.set(t,e);for(var D=l;++b<g;){C=p[b];var B=e[C],W=t[C];if(s)var He=l?s(W,B,C,t,e,h):s(B,W,C,e,t,h);if(!(He===i?B===W||a(B,W,r,s,h):He)){k=!1;break}D||(D=C=="constructor")}if(k&&!D){var Re=e.constructor,Ue=t.constructor;Re!=Ue&&"constructor"in e&&"constructor"in t&&!(typeof Re=="function"&&Re instanceof Re&&typeof Ue=="function"&&Ue instanceof Ue)&&(k=!1)}return h.delete(e),h.delete(t),k}function dt(e){return Zn(Pa(e,i,Da),e+"")}function zn(e){return Lo(e,ve,Qn)}function Bn(e){return Lo(e,Ne,_a)}var Gn=fi?function(e){return fi.get(e)}:ls;function Ci(e){for(var t=e.name+"",r=ir[t],s=Z.call(ir,t)?r.length:0;s--;){var a=r[s],h=a.func;if(h==null||h==e)return a.name}return t}function ar(e){var t=Z.call(u,"placeholder")?u:e;return t.placeholder}function N(){var e=u.iteratee||us;return e=e===us?ko:e,arguments.length?e(arguments[0],arguments[1]):e}function Ai(e,t){var r=e.__data__;return cp(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Wn(e){for(var t=ve(e),r=t.length;r--;){var s=t[r],a=e[s];t[r]=[s,a,Ia(a)]}return t}function Ut(e,t){var r=lh(e,t);return Uo(r)?r:i}function tp(e){var t=Z.call(e,$t),r=e[$t];try{e[$t]=i;var s=!0}catch{}var a=si.call(e);return s&&(t?e[$t]=r:delete e[$t]),a}var Qn=En?function(e){return e==null?[]:(e=X(e),It(En(e),function(t){return So.call(e,t)}))}:ps,_a=En?function(e){for(var t=[];e;)bt(t,Qn(e)),e=ci(e);return t}:ps,be=Pe;(In&&be(new In(new ArrayBuffer(1)))!=Kt||Pr&&be(new Pr)!=Ye||bn&&be(bn.resolve())!=Ts||rr&&be(new rr)!=Ze||Sr&&be(new Sr)!=wr)&&(be=function(e){var t=Pe(e),r=t==ut?e.constructor:i,s=r?kt(r):"";if(s)switch(s){case Mh:return Kt;case Lh:return Ye;case Hh:return Ts;case Uh:return Ze;case kh:return wr}return t});function rp(e,t,r){for(var s=-1,a=r.length;++s<a;){var h=r[s],l=h.size;switch(h.type){case"drop":e+=l;break;case"dropRight":t-=l;break;case"take":t=Ie(t,e+l);break;case"takeRight":e=ge(e,t-l);break}}return{start:e,end:t}}function ip(e){var t=e.match(uu);return t?t[1].split(hu):[]}function wa(e,t,r){t=At(t,e);for(var s=-1,a=t.length,h=!1;++s<a;){var l=ot(t[s]);if(!(h=e!=null&&r(e,l)))break;e=e[l]}return h||++s!=a?h:(a=e==null?0:e.length,!!a&&$i(a)&&gt(l,a)&&($(e)||Vt(e)))}function np(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Z.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Ea(e){return typeof e.constructor=="function"&&!Tr(e)?nr(ci(e)):{}}function sp(e,t,r){var s=e.constructor;switch(t){case Er:return kn(e);case gr:case vr:return new s(+e);case Kt:return Vl(e,r);case Gi:case Wi:case Qi:case Ki:case Ji:case Yi:case Zi:case Xi:case en:return ia(e,r);case Ye:return new s;case mr:case _r:return new s(e);case yr:return Fl(e);case Ze:return new s;case Kr:return zl(e)}}function op(e,t){var r=t.length;if(!r)return e;var s=r-1;return t[s]=(r>1?"& ":"")+t[s],t=t.join(r>2?", ":" "),e.replace(cu,`{
/* [wrapped with `+t+`] */
`)}function ap(e){return $(e)||Vt(e)||!!(Ro&&e&&e[Ro])}function gt(e,t){var r=typeof e;return t=t??ee,!!t&&(r=="number"||r!="symbol"&&_u.test(e))&&e>-1&&e%1==0&&e<t}function Se(e,t,r){if(!ae(r))return!1;var s=typeof t;return(s=="number"?Oe(r)&&gt(t,r.length):s=="string"&&t in r)?tt(r[t],e):!1}function Kn(e,t){if($(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Le(e)?!0:nu.test(e)||!iu.test(e)||t!=null&&e in X(t)}function cp(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Jn(e){var t=Ci(e),r=u[t];if(typeof r!="function"||!(t in G.prototype))return!1;if(e===r)return!0;var s=Gn(r);return!!s&&e===s[0]}function up(e){return!!Io&&Io in e}var hp=ii?vt:fs;function Tr(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||tr;return e===r}function Ia(e){return e===e&&!ae(e)}function ba(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==i||e in X(r))}}function lp(e){var t=Di(e,function(s){return r.size===q&&r.clear(),s}),r=t.cache;return t}function pp(e,t){var r=e[1],s=t[1],a=r|s,h=a<(pe|Ae|Je),l=s==Je&&r==fe||s==Je&&r==Te&&e[7].length<=t[8]||s==(Je|Te)&&t[7].length<=t[8]&&r==fe;if(!(h||l))return e;s&pe&&(e[2]=t[2],a|=r&pe?0:Wt);var p=t[3];if(p){var g=e[3];e[3]=g?sa(g,p,t[4]):p,e[4]=g?Pt(e[3],j):t[4]}return p=t[5],p&&(g=e[5],e[5]=g?oa(g,p,t[6]):p,e[6]=g?Pt(e[5],j):t[6]),p=t[7],p&&(e[7]=p),s&Je&&(e[8]=e[8]==null?t[8]:Ie(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function fp(e){var t=[];if(e!=null)for(var r in X(e))t.push(r);return t}function dp(e){return si.call(e)}function Pa(e,t,r){return t=ge(t===i?e.length-1:t,0),function(){for(var s=arguments,a=-1,h=ge(s.length-t,0),l=v(h);++a<h;)l[a]=s[t+a];a=-1;for(var p=v(t+1);++a<t;)p[a]=s[a];return p[t]=r(l),$e(e,this,p)}}function Sa(e,t){return t.length<2?e:Ht(e,We(t,0,-1))}function gp(e,t){for(var r=e.length,s=Ie(t.length,r),a=qe(e);s--;){var h=t[s];e[s]=gt(h,r)?a[h]:i}return e}function Yn(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ra=Aa(Ko),$r=Oh||function(e,t){return me.setTimeout(e,t)},Zn=Aa(Ll);function Ca(e,t,r){var s=t+"";return Zn(e,op(s,vp(ip(s),r)))}function Aa(e){var t=0,r=0;return function(){var s=Th(),a=fr-(s-r);if(r=s,a>0){if(++t>=Bi)return arguments[0]}else t=0;return e.apply(i,arguments)}}function qi(e,t){var r=-1,s=e.length,a=s-1;for(t=t===i?s:t;++r<t;){var h=Tn(r,a),l=e[h];e[h]=e[r],e[r]=l}return e.length=t,e}var qa=lp(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(su,function(r,s,a,h){t.push(a?h.replace(fu,"$1"):s||r)}),t});function ot(e){if(typeof e=="string"||Le(e))return e;var t=e+"";return t=="0"&&1/e==-ne?"-0":t}function kt(e){if(e!=null){try{return ni.call(e)}catch{}try{return e+""}catch{}}return""}function vp(e,t){return Fe(Fc,function(r){var s="_."+r[0];t&r[1]&&!Xr(e,s)&&e.push(s)}),e.sort()}function Oa(e){if(e instanceof G)return e.clone();var t=new Be(e.__wrapped__,e.__chain__);return t.__actions__=qe(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function mp(e,t,r){(r?Se(e,t,r):t===i)?t=1:t=ge(L(t),0);var s=e==null?0:e.length;if(!s||t<1)return[];for(var a=0,h=0,l=v(li(s/t));a<s;)l[h++]=We(e,a,a+=t);return l}function yp(e){for(var t=-1,r=e==null?0:e.length,s=0,a=[];++t<r;){var h=e[t];h&&(a[s++]=h)}return a}function _p(){var e=arguments.length;if(!e)return[];for(var t=v(e-1),r=arguments[0],s=e;s--;)t[s-1]=arguments[s];return bt($(r)?qe(r):[r],ye(t,1))}var wp=z(function(e,t){return he(e)?qr(e,ye(t,1,he,!0)):[]}),Ep=z(function(e,t){var r=Qe(t);return he(r)&&(r=i),he(e)?qr(e,ye(t,1,he,!0),N(r,2)):[]}),Ip=z(function(e,t){var r=Qe(t);return he(r)&&(r=i),he(e)?qr(e,ye(t,1,he,!0),i,r):[]});function bp(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),We(e,t<0?0:t,s)):[]}function Pp(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),t=s-t,We(e,0,t<0?0:t)):[]}function Sp(e,t){return e&&e.length?Ei(e,N(t,3),!0,!0):[]}function Rp(e,t){return e&&e.length?Ei(e,N(t,3),!0):[]}function Cp(e,t,r,s){var a=e==null?0:e.length;return a?(r&&typeof r!="number"&&Se(e,t,r)&&(r=0,s=a),_l(e,t,r,s)):[]}function Na(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:L(r);return a<0&&(a=ge(s+a,0)),ei(e,N(t,3),a)}function xa(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=s-1;return r!==i&&(a=L(r),a=r<0?ge(s+a,0):Ie(a,s-1)),ei(e,N(t,3),a,!0)}function Da(e){var t=e==null?0:e.length;return t?ye(e,1):[]}function Ap(e){var t=e==null?0:e.length;return t?ye(e,ne):[]}function qp(e,t){var r=e==null?0:e.length;return r?(t=t===i?1:L(t),ye(e,t)):[]}function Op(e){for(var t=-1,r=e==null?0:e.length,s={};++t<r;){var a=e[t];s[a[0]]=a[1]}return s}function Ta(e){return e&&e.length?e[0]:i}function Np(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:L(r);return a<0&&(a=ge(s+a,0)),Yt(e,t,a)}function xp(e){var t=e==null?0:e.length;return t?We(e,0,-1):[]}var Dp=z(function(e){var t=se(e,Hn);return t.length&&t[0]===e[0]?qn(t):[]}),Tp=z(function(e){var t=Qe(e),r=se(e,Hn);return t===Qe(r)?t=i:r.pop(),r.length&&r[0]===e[0]?qn(r,N(t,2)):[]}),$p=z(function(e){var t=Qe(e),r=se(e,Hn);return t=typeof t=="function"?t:i,t&&r.pop(),r.length&&r[0]===e[0]?qn(r,i,t):[]});function jp(e,t){return e==null?"":xh.call(e,t)}function Qe(e){var t=e==null?0:e.length;return t?e[t-1]:i}function Mp(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=s;return r!==i&&(a=L(r),a=a<0?ge(s+a,0):Ie(a,s-1)),t===t?vh(e,t,a):ei(e,fo,a,!0)}function Lp(e,t){return e&&e.length?Bo(e,L(t)):i}var Hp=z($a);function $a(e,t){return e&&e.length&&t&&t.length?Dn(e,t):e}function Up(e,t,r){return e&&e.length&&t&&t.length?Dn(e,t,N(r,2)):e}function kp(e,t,r){return e&&e.length&&t&&t.length?Dn(e,t,i,r):e}var Vp=dt(function(e,t){var r=e==null?0:e.length,s=Sn(e,t);return Qo(e,se(t,function(a){return gt(a,r)?+a:a}).sort(na)),s});function Fp(e,t){var r=[];if(!(e&&e.length))return r;var s=-1,a=[],h=e.length;for(t=N(t,3);++s<h;){var l=e[s];t(l,s,e)&&(r.push(l),a.push(s))}return Qo(e,a),r}function Xn(e){return e==null?e:jh.call(e)}function zp(e,t,r){var s=e==null?0:e.length;return s?(r&&typeof r!="number"&&Se(e,t,r)?(t=0,r=s):(t=t==null?0:L(t),r=r===i?s:L(r)),We(e,t,r)):[]}function Bp(e,t){return wi(e,t)}function Gp(e,t,r){return jn(e,t,N(r,2))}function Wp(e,t){var r=e==null?0:e.length;if(r){var s=wi(e,t);if(s<r&&tt(e[s],t))return s}return-1}function Qp(e,t){return wi(e,t,!0)}function Kp(e,t,r){return jn(e,t,N(r,2),!0)}function Jp(e,t){var r=e==null?0:e.length;if(r){var s=wi(e,t,!0)-1;if(tt(e[s],t))return s}return-1}function Yp(e){return e&&e.length?Jo(e):[]}function Zp(e,t){return e&&e.length?Jo(e,N(t,2)):[]}function Xp(e){var t=e==null?0:e.length;return t?We(e,1,t):[]}function ef(e,t,r){return e&&e.length?(t=r||t===i?1:L(t),We(e,0,t<0?0:t)):[]}function tf(e,t,r){var s=e==null?0:e.length;return s?(t=r||t===i?1:L(t),t=s-t,We(e,t<0?0:t,s)):[]}function rf(e,t){return e&&e.length?Ei(e,N(t,3),!1,!0):[]}function nf(e,t){return e&&e.length?Ei(e,N(t,3)):[]}var sf=z(function(e){return Ct(ye(e,1,he,!0))}),of=z(function(e){var t=Qe(e);return he(t)&&(t=i),Ct(ye(e,1,he,!0),N(t,2))}),af=z(function(e){var t=Qe(e);return t=typeof t=="function"?t:i,Ct(ye(e,1,he,!0),i,t)});function cf(e){return e&&e.length?Ct(e):[]}function uf(e,t){return e&&e.length?Ct(e,N(t,2)):[]}function hf(e,t){return t=typeof t=="function"?t:i,e&&e.length?Ct(e,i,t):[]}function es(e){if(!(e&&e.length))return[];var t=0;return e=It(e,function(r){if(he(r))return t=ge(r.length,t),!0}),mn(t,function(r){return se(e,dn(r))})}function ja(e,t){if(!(e&&e.length))return[];var r=es(e);return t==null?r:se(r,function(s){return $e(t,i,s)})}var lf=z(function(e,t){return he(e)?qr(e,t):[]}),pf=z(function(e){return Ln(It(e,he))}),ff=z(function(e){var t=Qe(e);return he(t)&&(t=i),Ln(It(e,he),N(t,2))}),df=z(function(e){var t=Qe(e);return t=typeof t=="function"?t:i,Ln(It(e,he),i,t)}),gf=z(es);function vf(e,t){return ea(e||[],t||[],Ar)}function mf(e,t){return ea(e||[],t||[],xr)}var yf=z(function(e){var t=e.length,r=t>1?e[t-1]:i;return r=typeof r=="function"?(e.pop(),r):i,ja(e,r)});function Ma(e){var t=u(e);return t.__chain__=!0,t}function _f(e,t){return t(e),e}function Oi(e,t){return t(e)}var wf=dt(function(e){var t=e.length,r=t?e[0]:0,s=this.__wrapped__,a=function(h){return Sn(h,e)};return t>1||this.__actions__.length||!(s instanceof G)||!gt(r)?this.thru(a):(s=s.slice(r,+r+(t?1:0)),s.__actions__.push({func:Oi,args:[a],thisArg:i}),new Be(s,this.__chain__).thru(function(h){return t&&!h.length&&h.push(i),h}))});function Ef(){return Ma(this)}function If(){return new Be(this.value(),this.__chain__)}function bf(){this.__values__===i&&(this.__values__=Ya(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function Pf(){return this}function Sf(e){for(var t,r=this;r instanceof gi;){var s=Oa(r);s.__index__=0,s.__values__=i,t?a.__wrapped__=s:t=s;var a=s;r=r.__wrapped__}return a.__wrapped__=e,t}function Rf(){var e=this.__wrapped__;if(e instanceof G){var t=e;return this.__actions__.length&&(t=new G(this)),t=t.reverse(),t.__actions__.push({func:Oi,args:[Xn],thisArg:i}),new Be(t,this.__chain__)}return this.thru(Xn)}function Cf(){return Xo(this.__wrapped__,this.__actions__)}var Af=Ii(function(e,t,r){Z.call(e,r)?++e[r]:pt(e,r,1)});function qf(e,t,r){var s=$(e)?lo:yl;return r&&Se(e,t,r)&&(t=i),s(e,N(t,3))}function Of(e,t){var r=$(e)?It:jo;return r(e,N(t,3))}var Nf=ha(Na),xf=ha(xa);function Df(e,t){return ye(Ni(e,t),1)}function Tf(e,t){return ye(Ni(e,t),ne)}function $f(e,t,r){return r=r===i?1:L(r),ye(Ni(e,t),r)}function La(e,t){var r=$(e)?Fe:Rt;return r(e,N(t,3))}function Ha(e,t){var r=$(e)?Xu:$o;return r(e,N(t,3))}var jf=Ii(function(e,t,r){Z.call(e,r)?e[r].push(t):pt(e,r,[t])});function Mf(e,t,r,s){e=Oe(e)?e:ur(e),r=r&&!s?L(r):0;var a=e.length;return r<0&&(r=ge(a+r,0)),ji(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&Yt(e,t,r)>-1}var Lf=z(function(e,t,r){var s=-1,a=typeof t=="function",h=Oe(e)?v(e.length):[];return Rt(e,function(l){h[++s]=a?$e(t,l,r):Or(l,t,r)}),h}),Hf=Ii(function(e,t,r){pt(e,r,t)});function Ni(e,t){var r=$(e)?se:Vo;return r(e,N(t,3))}function Uf(e,t,r,s){return e==null?[]:($(t)||(t=t==null?[]:[t]),r=s?i:r,$(r)||(r=r==null?[]:[r]),Go(e,t,r))}var kf=Ii(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});function Vf(e,t,r){var s=$(e)?pn:vo,a=arguments.length<3;return s(e,N(t,4),r,a,Rt)}function Ff(e,t,r){var s=$(e)?eh:vo,a=arguments.length<3;return s(e,N(t,4),r,a,$o)}function zf(e,t){var r=$(e)?It:jo;return r(e,Ti(N(t,3)))}function Bf(e){var t=$(e)?No:jl;return t(e)}function Gf(e,t,r){(r?Se(e,t,r):t===i)?t=1:t=L(t);var s=$(e)?fl:Ml;return s(e,t)}function Wf(e){var t=$(e)?dl:Hl;return t(e)}function Qf(e){if(e==null)return 0;if(Oe(e))return ji(e)?Xt(e):e.length;var t=be(e);return t==Ye||t==Ze?e.size:Nn(e).length}function Kf(e,t,r){var s=$(e)?fn:Ul;return r&&Se(e,t,r)&&(t=i),s(e,N(t,3))}var Jf=z(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Se(e,t[0],t[1])?t=[]:r>2&&Se(t[0],t[1],t[2])&&(t=[t[0]]),Go(e,ye(t,1),[])}),xi=qh||function(){return me.Date.now()};function Yf(e,t){if(typeof t!="function")throw new ze(y);return e=L(e),function(){if(--e<1)return t.apply(this,arguments)}}function Ua(e,t,r){return t=r?i:t,t=e&&t==null?e.length:t,ft(e,Je,i,i,i,i,t)}function ka(e,t){var r;if(typeof t!="function")throw new ze(y);return e=L(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=i),r}}var ts=z(function(e,t,r){var s=pe;if(r.length){var a=Pt(r,ar(ts));s|=we}return ft(e,s,t,r,a)}),Va=z(function(e,t,r){var s=pe|Ae;if(r.length){var a=Pt(r,ar(Va));s|=we}return ft(t,s,e,r,a)});function Fa(e,t,r){t=r?i:t;var s=ft(e,fe,i,i,i,i,i,t);return s.placeholder=Fa.placeholder,s}function za(e,t,r){t=r?i:t;var s=ft(e,ue,i,i,i,i,i,t);return s.placeholder=za.placeholder,s}function Ba(e,t,r){var s,a,h,l,p,g,w=0,E=!1,b=!1,C=!0;if(typeof e!="function")throw new ze(y);t=Ke(t)||0,ae(r)&&(E=!!r.leading,b="maxWait"in r,h=b?ge(Ke(r.maxWait)||0,t):h,C="trailing"in r?!!r.trailing:C);function O(le){var rt=s,yt=a;return s=a=i,w=le,l=e.apply(yt,rt),l}function x(le){return w=le,p=$r(B,t),E?O(le):l}function k(le){var rt=le-g,yt=le-w,hc=t-rt;return b?Ie(hc,h-yt):hc}function D(le){var rt=le-g,yt=le-w;return g===i||rt>=t||rt<0||b&&yt>=h}function B(){var le=xi();if(D(le))return W(le);p=$r(B,k(le))}function W(le){return p=i,C&&s?O(le):(s=a=i,l)}function He(){p!==i&&ta(p),w=0,s=g=a=p=i}function Re(){return p===i?l:W(xi())}function Ue(){var le=xi(),rt=D(le);if(s=arguments,a=this,g=le,rt){if(p===i)return x(g);if(b)return ta(p),p=$r(B,t),O(g)}return p===i&&(p=$r(B,t)),l}return Ue.cancel=He,Ue.flush=Re,Ue}var Zf=z(function(e,t){return To(e,1,t)}),Xf=z(function(e,t,r){return To(e,Ke(t)||0,r)});function ed(e){return ft(e,pr)}function Di(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new ze(y);var r=function(){var s=arguments,a=t?t.apply(this,s):s[0],h=r.cache;if(h.has(a))return h.get(a);var l=e.apply(this,s);return r.cache=h.set(a,l)||h,l};return r.cache=new(Di.Cache||lt),r}Di.Cache=lt;function Ti(e){if(typeof e!="function")throw new ze(y);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function td(e){return ka(2,e)}var rd=kl(function(e,t){t=t.length==1&&$(t[0])?se(t[0],je(N())):se(ye(t,1),je(N()));var r=t.length;return z(function(s){for(var a=-1,h=Ie(s.length,r);++a<h;)s[a]=t[a].call(this,s[a]);return $e(e,this,s)})}),rs=z(function(e,t){var r=Pt(t,ar(rs));return ft(e,we,i,t,r)}),Ga=z(function(e,t){var r=Pt(t,ar(Ga));return ft(e,Et,i,t,r)}),id=dt(function(e,t){return ft(e,Te,i,i,i,t)});function nd(e,t){if(typeof e!="function")throw new ze(y);return t=t===i?t:L(t),z(e,t)}function sd(e,t){if(typeof e!="function")throw new ze(y);return t=t==null?0:ge(L(t),0),z(function(r){var s=r[t],a=qt(r,0,t);return s&&bt(a,s),$e(e,this,a)})}function od(e,t,r){var s=!0,a=!0;if(typeof e!="function")throw new ze(y);return ae(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),Ba(e,t,{leading:s,maxWait:t,trailing:a})}function ad(e){return Ua(e,1)}function cd(e,t){return rs(Un(t),e)}function ud(){if(!arguments.length)return[];var e=arguments[0];return $(e)?e:[e]}function hd(e){return Ge(e,J)}function ld(e,t){return t=typeof t=="function"?t:i,Ge(e,J,t)}function pd(e){return Ge(e,M|J)}function fd(e,t){return t=typeof t=="function"?t:i,Ge(e,M|J,t)}function dd(e,t){return t==null||Do(e,t,ve(t))}function tt(e,t){return e===t||e!==e&&t!==t}var gd=Ri(An),vd=Ri(function(e,t){return e>=t}),Vt=Ho(function(){return arguments}())?Ho:function(e){return ce(e)&&Z.call(e,"callee")&&!So.call(e,"callee")},$=v.isArray,md=so?je(so):Pl;function Oe(e){return e!=null&&$i(e.length)&&!vt(e)}function he(e){return ce(e)&&Oe(e)}function yd(e){return e===!0||e===!1||ce(e)&&Pe(e)==gr}var Ot=Nh||fs,_d=oo?je(oo):Sl;function wd(e){return ce(e)&&e.nodeType===1&&!jr(e)}function Ed(e){if(e==null)return!0;if(Oe(e)&&($(e)||typeof e=="string"||typeof e.splice=="function"||Ot(e)||cr(e)||Vt(e)))return!e.length;var t=be(e);if(t==Ye||t==Ze)return!e.size;if(Tr(e))return!Nn(e).length;for(var r in e)if(Z.call(e,r))return!1;return!0}function Id(e,t){return Nr(e,t)}function bd(e,t,r){r=typeof r=="function"?r:i;var s=r?r(e,t):i;return s===i?Nr(e,t,i,r):!!s}function is(e){if(!ce(e))return!1;var t=Pe(e);return t==Wr||t==Bc||typeof e.message=="string"&&typeof e.name=="string"&&!jr(e)}function Pd(e){return typeof e=="number"&&Co(e)}function vt(e){if(!ae(e))return!1;var t=Pe(e);return t==Qr||t==Ds||t==zc||t==Wc}function Wa(e){return typeof e=="number"&&e==L(e)}function $i(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ee}function ae(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ce(e){return e!=null&&typeof e=="object"}var Qa=ao?je(ao):Cl;function Sd(e,t){return e===t||On(e,t,Wn(t))}function Rd(e,t,r){return r=typeof r=="function"?r:i,On(e,t,Wn(t),r)}function Cd(e){return Ka(e)&&e!=+e}function Ad(e){if(hp(e))throw new T(f);return Uo(e)}function qd(e){return e===null}function Od(e){return e==null}function Ka(e){return typeof e=="number"||ce(e)&&Pe(e)==mr}function jr(e){if(!ce(e)||Pe(e)!=ut)return!1;var t=ci(e);if(t===null)return!0;var r=Z.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&ni.call(r)==Sh}var ns=co?je(co):Al;function Nd(e){return Wa(e)&&e>=-ee&&e<=ee}var Ja=uo?je(uo):ql;function ji(e){return typeof e=="string"||!$(e)&&ce(e)&&Pe(e)==_r}function Le(e){return typeof e=="symbol"||ce(e)&&Pe(e)==Kr}var cr=ho?je(ho):Ol;function xd(e){return e===i}function Dd(e){return ce(e)&&be(e)==wr}function Td(e){return ce(e)&&Pe(e)==Kc}var $d=Ri(xn),jd=Ri(function(e,t){return e<=t});function Ya(e){if(!e)return[];if(Oe(e))return ji(e)?Xe(e):qe(e);if(br&&e[br])return fh(e[br]());var t=be(e),r=t==Ye?_n:t==Ze?ti:ur;return r(e)}function mt(e){if(!e)return e===0?e:0;if(e=Ke(e),e===ne||e===-ne){var t=e<0?-1:1;return t*Y}return e===e?e:0}function L(e){var t=mt(e),r=t%1;return t===t?r?t-r:t:0}function Za(e){return e?Lt(L(e),0,Ee):0}function Ke(e){if(typeof e=="number")return e;if(Le(e))return ct;if(ae(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ae(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=mo(e);var r=vu.test(e);return r||yu.test(e)?Ju(e.slice(2),r?2:8):gu.test(e)?ct:+e}function Xa(e){return st(e,Ne(e))}function Md(e){return e?Lt(L(e),-ee,ee):e===0?e:0}function K(e){return e==null?"":Me(e)}var Ld=sr(function(e,t){if(Tr(t)||Oe(t)){st(t,ve(t),e);return}for(var r in t)Z.call(t,r)&&Ar(e,r,t[r])}),ec=sr(function(e,t){st(t,Ne(t),e)}),Mi=sr(function(e,t,r,s){st(t,Ne(t),e,s)}),Hd=sr(function(e,t,r,s){st(t,ve(t),e,s)}),Ud=dt(Sn);function kd(e,t){var r=nr(e);return t==null?r:xo(r,t)}var Vd=z(function(e,t){e=X(e);var r=-1,s=t.length,a=s>2?t[2]:i;for(a&&Se(t[0],t[1],a)&&(s=1);++r<s;)for(var h=t[r],l=Ne(h),p=-1,g=l.length;++p<g;){var w=l[p],E=e[w];(E===i||tt(E,tr[w])&&!Z.call(e,w))&&(e[w]=h[w])}return e}),Fd=z(function(e){return e.push(i,ma),$e(tc,i,e)});function zd(e,t){return po(e,N(t,3),nt)}function Bd(e,t){return po(e,N(t,3),Cn)}function Gd(e,t){return e==null?e:Rn(e,N(t,3),Ne)}function Wd(e,t){return e==null?e:Mo(e,N(t,3),Ne)}function Qd(e,t){return e&&nt(e,N(t,3))}function Kd(e,t){return e&&Cn(e,N(t,3))}function Jd(e){return e==null?[]:yi(e,ve(e))}function Yd(e){return e==null?[]:yi(e,Ne(e))}function ss(e,t,r){var s=e==null?i:Ht(e,t);return s===i?r:s}function Zd(e,t){return e!=null&&wa(e,t,wl)}function os(e,t){return e!=null&&wa(e,t,El)}var Xd=pa(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=si.call(t)),e[t]=r},cs(xe)),eg=pa(function(e,t,r){t!=null&&typeof t.toString!="function"&&(t=si.call(t)),Z.call(e,t)?e[t].push(r):e[t]=[r]},N),tg=z(Or);function ve(e){return Oe(e)?Oo(e):Nn(e)}function Ne(e){return Oe(e)?Oo(e,!0):Nl(e)}function rg(e,t){var r={};return t=N(t,3),nt(e,function(s,a,h){pt(r,t(s,a,h),s)}),r}function ig(e,t){var r={};return t=N(t,3),nt(e,function(s,a,h){pt(r,a,t(s,a,h))}),r}var ng=sr(function(e,t,r){_i(e,t,r)}),tc=sr(function(e,t,r,s){_i(e,t,r,s)}),sg=dt(function(e,t){var r={};if(e==null)return r;var s=!1;t=se(t,function(h){return h=At(h,e),s||(s=h.length>1),h}),st(e,Bn(e),r),s&&(r=Ge(r,M|H|J,Zl));for(var a=t.length;a--;)Mn(r,t[a]);return r});function og(e,t){return rc(e,Ti(N(t)))}var ag=dt(function(e,t){return e==null?{}:Dl(e,t)});function rc(e,t){if(e==null)return{};var r=se(Bn(e),function(s){return[s]});return t=N(t),Wo(e,r,function(s,a){return t(s,a[0])})}function cg(e,t,r){t=At(t,e);var s=-1,a=t.length;for(a||(a=1,e=i);++s<a;){var h=e==null?i:e[ot(t[s])];h===i&&(s=a,h=r),e=vt(h)?h.call(e):h}return e}function ug(e,t,r){return e==null?e:xr(e,t,r)}function hg(e,t,r,s){return s=typeof s=="function"?s:i,e==null?e:xr(e,t,r,s)}var ic=ga(ve),nc=ga(Ne);function lg(e,t,r){var s=$(e),a=s||Ot(e)||cr(e);if(t=N(t,4),r==null){var h=e&&e.constructor;a?r=s?new h:[]:ae(e)?r=vt(h)?nr(ci(e)):{}:r={}}return(a?Fe:nt)(e,function(l,p,g){return t(r,l,p,g)}),r}function pg(e,t){return e==null?!0:Mn(e,t)}function fg(e,t,r){return e==null?e:Zo(e,t,Un(r))}function dg(e,t,r,s){return s=typeof s=="function"?s:i,e==null?e:Zo(e,t,Un(r),s)}function ur(e){return e==null?[]:yn(e,ve(e))}function gg(e){return e==null?[]:yn(e,Ne(e))}function vg(e,t,r){return r===i&&(r=t,t=i),r!==i&&(r=Ke(r),r=r===r?r:0),t!==i&&(t=Ke(t),t=t===t?t:0),Lt(Ke(e),t,r)}function mg(e,t,r){return t=mt(t),r===i?(r=t,t=0):r=mt(r),e=Ke(e),Il(e,t,r)}function yg(e,t,r){if(r&&typeof r!="boolean"&&Se(e,t,r)&&(t=r=i),r===i&&(typeof t=="boolean"?(r=t,t=i):typeof e=="boolean"&&(r=e,e=i)),e===i&&t===i?(e=0,t=1):(e=mt(e),t===i?(t=e,e=0):t=mt(t)),e>t){var s=e;e=t,t=s}if(r||e%1||t%1){var a=Ao();return Ie(e+a*(t-e+Ku("1e-"+((a+"").length-1))),t)}return Tn(e,t)}var _g=or(function(e,t,r){return t=t.toLowerCase(),e+(r?sc(t):t)});function sc(e){return as(K(e).toLowerCase())}function oc(e){return e=K(e),e&&e.replace(wu,ch).replace(Hu,"")}function wg(e,t,r){e=K(e),t=Me(t);var s=e.length;r=r===i?s:Lt(L(r),0,s);var a=r;return r-=t.length,r>=0&&e.slice(r,a)==t}function Eg(e){return e=K(e),e&&eu.test(e)?e.replace(js,uh):e}function Ig(e){return e=K(e),e&&ou.test(e)?e.replace(tn,"\\$&"):e}var bg=or(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),Pg=or(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),Sg=ua("toLowerCase");function Rg(e,t,r){e=K(e),t=L(t);var s=t?Xt(e):0;if(!t||s>=t)return e;var a=(t-s)/2;return Si(pi(a),r)+e+Si(li(a),r)}function Cg(e,t,r){e=K(e),t=L(t);var s=t?Xt(e):0;return t&&s<t?e+Si(t-s,r):e}function Ag(e,t,r){e=K(e),t=L(t);var s=t?Xt(e):0;return t&&s<t?Si(t-s,r)+e:e}function qg(e,t,r){return r||t==null?t=0:t&&(t=+t),$h(K(e).replace(rn,""),t||0)}function Og(e,t,r){return(r?Se(e,t,r):t===i)?t=1:t=L(t),$n(K(e),t)}function Ng(){var e=arguments,t=K(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var xg=or(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()});function Dg(e,t,r){return r&&typeof r!="number"&&Se(e,t,r)&&(t=r=i),r=r===i?Ee:r>>>0,r?(e=K(e),e&&(typeof t=="string"||t!=null&&!ns(t))&&(t=Me(t),!t&&Zt(e))?qt(Xe(e),0,r):e.split(t,r)):[]}var Tg=or(function(e,t,r){return e+(r?" ":"")+as(t)});function $g(e,t,r){return e=K(e),r=r==null?0:Lt(L(r),0,e.length),t=Me(t),e.slice(r,r+t.length)==t}function jg(e,t,r){var s=u.templateSettings;r&&Se(e,t,r)&&(t=i),e=K(e),t=Mi({},t,s,va);var a=Mi({},t.imports,s.imports,va),h=ve(a),l=yn(a,h),p,g,w=0,E=t.interpolate||Jr,b="__p += '",C=wn((t.escape||Jr).source+"|"+E.source+"|"+(E===Ms?du:Jr).source+"|"+(t.evaluate||Jr).source+"|$","g"),O="//# sourceURL="+(Z.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zu+"]")+`
`;e.replace(C,function(D,B,W,He,Re,Ue){return W||(W=He),b+=e.slice(w,Ue).replace(Eu,hh),B&&(p=!0,b+=`' +
__e(`+B+`) +
'`),Re&&(g=!0,b+=`';
`+Re+`;
__p += '`),W&&(b+=`' +
((__t = (`+W+`)) == null ? '' : __t) +
'`),w=Ue+D.length,D}),b+=`';
`;var x=Z.call(t,"variable")&&t.variable;if(!x)b=`with (obj) {
`+b+`
}
`;else if(pu.test(x))throw new T(I);b=(g?b.replace(Jc,""):b).replace(Yc,"$1").replace(Zc,"$1;"),b="function("+(x||"obj")+`) {
`+(x?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(p?", __e = _.escape":"")+(g?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+b+`return __p
}`;var k=cc(function(){return Q(h,O+"return "+b).apply(i,l)});if(k.source=b,is(k))throw k;return k}function Mg(e){return K(e).toLowerCase()}function Lg(e){return K(e).toUpperCase()}function Hg(e,t,r){if(e=K(e),e&&(r||t===i))return mo(e);if(!e||!(t=Me(t)))return e;var s=Xe(e),a=Xe(t),h=yo(s,a),l=_o(s,a)+1;return qt(s,h,l).join("")}function Ug(e,t,r){if(e=K(e),e&&(r||t===i))return e.slice(0,Eo(e)+1);if(!e||!(t=Me(t)))return e;var s=Xe(e),a=_o(s,Xe(t))+1;return qt(s,0,a).join("")}function kg(e,t,r){if(e=K(e),e&&(r||t===i))return e.replace(rn,"");if(!e||!(t=Me(t)))return e;var s=Xe(e),a=yo(s,Xe(t));return qt(s,a).join("")}function Vg(e,t){var r=zi,s=ke;if(ae(t)){var a="separator"in t?t.separator:a;r="length"in t?L(t.length):r,s="omission"in t?Me(t.omission):s}e=K(e);var h=e.length;if(Zt(e)){var l=Xe(e);h=l.length}if(r>=h)return e;var p=r-Xt(s);if(p<1)return s;var g=l?qt(l,0,p).join(""):e.slice(0,p);if(a===i)return g+s;if(l&&(p+=g.length-p),ns(a)){if(e.slice(p).search(a)){var w,E=g;for(a.global||(a=wn(a.source,K(Ls.exec(a))+"g")),a.lastIndex=0;w=a.exec(E);)var b=w.index;g=g.slice(0,b===i?p:b)}}else if(e.indexOf(Me(a),p)!=p){var C=g.lastIndexOf(a);C>-1&&(g=g.slice(0,C))}return g+s}function Fg(e){return e=K(e),e&&Xc.test(e)?e.replace($s,mh):e}var zg=or(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),as=ua("toUpperCase");function ac(e,t,r){return e=K(e),t=r?i:t,t===i?ph(e)?wh(e):ih(e):e.match(t)||[]}var cc=z(function(e,t){try{return $e(e,i,t)}catch(r){return is(r)?r:new T(r)}}),Bg=dt(function(e,t){return Fe(t,function(r){r=ot(r),pt(e,r,ts(e[r],e))}),e});function Gg(e){var t=e==null?0:e.length,r=N();return e=t?se(e,function(s){if(typeof s[1]!="function")throw new ze(y);return[r(s[0]),s[1]]}):[],z(function(s){for(var a=-1;++a<t;){var h=e[a];if($e(h[0],this,s))return $e(h[1],this,s)}})}function Wg(e){return ml(Ge(e,M))}function cs(e){return function(){return e}}function Qg(e,t){return e==null||e!==e?t:e}var Kg=la(),Jg=la(!0);function xe(e){return e}function us(e){return ko(typeof e=="function"?e:Ge(e,M))}function Yg(e){return Fo(Ge(e,M))}function Zg(e,t){return zo(e,Ge(t,M))}var Xg=z(function(e,t){return function(r){return Or(r,e,t)}}),ev=z(function(e,t){return function(r){return Or(e,r,t)}});function hs(e,t,r){var s=ve(t),a=yi(t,s);r==null&&!(ae(t)&&(a.length||!s.length))&&(r=t,t=e,e=this,a=yi(t,ve(t)));var h=!(ae(r)&&"chain"in r)||!!r.chain,l=vt(e);return Fe(a,function(p){var g=t[p];e[p]=g,l&&(e.prototype[p]=function(){var w=this.__chain__;if(h||w){var E=e(this.__wrapped__),b=E.__actions__=qe(this.__actions__);return b.push({func:g,args:arguments,thisArg:e}),E.__chain__=w,E}return g.apply(e,bt([this.value()],arguments))})}),e}function tv(){return me._===this&&(me._=Rh),this}function ls(){}function rv(e){return e=L(e),z(function(t){return Bo(t,e)})}var iv=Vn(se),nv=Vn(lo),sv=Vn(fn);function uc(e){return Kn(e)?dn(ot(e)):Tl(e)}function ov(e){return function(t){return e==null?i:Ht(e,t)}}var av=fa(),cv=fa(!0);function ps(){return[]}function fs(){return!1}function uv(){return{}}function hv(){return""}function lv(){return!0}function pv(e,t){if(e=L(e),e<1||e>ee)return[];var r=Ee,s=Ie(e,Ee);t=N(t),e-=Ee;for(var a=mn(s,t);++r<e;)t(r);return a}function fv(e){return $(e)?se(e,ot):Le(e)?[e]:qe(qa(K(e)))}function dv(e){var t=++Ph;return K(e)+t}var gv=Pi(function(e,t){return e+t},0),vv=Fn("ceil"),mv=Pi(function(e,t){return e/t},1),yv=Fn("floor");function _v(e){return e&&e.length?mi(e,xe,An):i}function wv(e,t){return e&&e.length?mi(e,N(t,2),An):i}function Ev(e){return go(e,xe)}function Iv(e,t){return go(e,N(t,2))}function bv(e){return e&&e.length?mi(e,xe,xn):i}function Pv(e,t){return e&&e.length?mi(e,N(t,2),xn):i}var Sv=Pi(function(e,t){return e*t},1),Rv=Fn("round"),Cv=Pi(function(e,t){return e-t},0);function Av(e){return e&&e.length?vn(e,xe):0}function qv(e,t){return e&&e.length?vn(e,N(t,2)):0}return u.after=Yf,u.ary=Ua,u.assign=Ld,u.assignIn=ec,u.assignInWith=Mi,u.assignWith=Hd,u.at=Ud,u.before=ka,u.bind=ts,u.bindAll=Bg,u.bindKey=Va,u.castArray=ud,u.chain=Ma,u.chunk=mp,u.compact=yp,u.concat=_p,u.cond=Gg,u.conforms=Wg,u.constant=cs,u.countBy=Af,u.create=kd,u.curry=Fa,u.curryRight=za,u.debounce=Ba,u.defaults=Vd,u.defaultsDeep=Fd,u.defer=Zf,u.delay=Xf,u.difference=wp,u.differenceBy=Ep,u.differenceWith=Ip,u.drop=bp,u.dropRight=Pp,u.dropRightWhile=Sp,u.dropWhile=Rp,u.fill=Cp,u.filter=Of,u.flatMap=Df,u.flatMapDeep=Tf,u.flatMapDepth=$f,u.flatten=Da,u.flattenDeep=Ap,u.flattenDepth=qp,u.flip=ed,u.flow=Kg,u.flowRight=Jg,u.fromPairs=Op,u.functions=Jd,u.functionsIn=Yd,u.groupBy=jf,u.initial=xp,u.intersection=Dp,u.intersectionBy=Tp,u.intersectionWith=$p,u.invert=Xd,u.invertBy=eg,u.invokeMap=Lf,u.iteratee=us,u.keyBy=Hf,u.keys=ve,u.keysIn=Ne,u.map=Ni,u.mapKeys=rg,u.mapValues=ig,u.matches=Yg,u.matchesProperty=Zg,u.memoize=Di,u.merge=ng,u.mergeWith=tc,u.method=Xg,u.methodOf=ev,u.mixin=hs,u.negate=Ti,u.nthArg=rv,u.omit=sg,u.omitBy=og,u.once=td,u.orderBy=Uf,u.over=iv,u.overArgs=rd,u.overEvery=nv,u.overSome=sv,u.partial=rs,u.partialRight=Ga,u.partition=kf,u.pick=ag,u.pickBy=rc,u.property=uc,u.propertyOf=ov,u.pull=Hp,u.pullAll=$a,u.pullAllBy=Up,u.pullAllWith=kp,u.pullAt=Vp,u.range=av,u.rangeRight=cv,u.rearg=id,u.reject=zf,u.remove=Fp,u.rest=nd,u.reverse=Xn,u.sampleSize=Gf,u.set=ug,u.setWith=hg,u.shuffle=Wf,u.slice=zp,u.sortBy=Jf,u.sortedUniq=Yp,u.sortedUniqBy=Zp,u.split=Dg,u.spread=sd,u.tail=Xp,u.take=ef,u.takeRight=tf,u.takeRightWhile=rf,u.takeWhile=nf,u.tap=_f,u.throttle=od,u.thru=Oi,u.toArray=Ya,u.toPairs=ic,u.toPairsIn=nc,u.toPath=fv,u.toPlainObject=Xa,u.transform=lg,u.unary=ad,u.union=sf,u.unionBy=of,u.unionWith=af,u.uniq=cf,u.uniqBy=uf,u.uniqWith=hf,u.unset=pg,u.unzip=es,u.unzipWith=ja,u.update=fg,u.updateWith=dg,u.values=ur,u.valuesIn=gg,u.without=lf,u.words=ac,u.wrap=cd,u.xor=pf,u.xorBy=ff,u.xorWith=df,u.zip=gf,u.zipObject=vf,u.zipObjectDeep=mf,u.zipWith=yf,u.entries=ic,u.entriesIn=nc,u.extend=ec,u.extendWith=Mi,hs(u,u),u.add=gv,u.attempt=cc,u.camelCase=_g,u.capitalize=sc,u.ceil=vv,u.clamp=vg,u.clone=hd,u.cloneDeep=pd,u.cloneDeepWith=fd,u.cloneWith=ld,u.conformsTo=dd,u.deburr=oc,u.defaultTo=Qg,u.divide=mv,u.endsWith=wg,u.eq=tt,u.escape=Eg,u.escapeRegExp=Ig,u.every=qf,u.find=Nf,u.findIndex=Na,u.findKey=zd,u.findLast=xf,u.findLastIndex=xa,u.findLastKey=Bd,u.floor=yv,u.forEach=La,u.forEachRight=Ha,u.forIn=Gd,u.forInRight=Wd,u.forOwn=Qd,u.forOwnRight=Kd,u.get=ss,u.gt=gd,u.gte=vd,u.has=Zd,u.hasIn=os,u.head=Ta,u.identity=xe,u.includes=Mf,u.indexOf=Np,u.inRange=mg,u.invoke=tg,u.isArguments=Vt,u.isArray=$,u.isArrayBuffer=md,u.isArrayLike=Oe,u.isArrayLikeObject=he,u.isBoolean=yd,u.isBuffer=Ot,u.isDate=_d,u.isElement=wd,u.isEmpty=Ed,u.isEqual=Id,u.isEqualWith=bd,u.isError=is,u.isFinite=Pd,u.isFunction=vt,u.isInteger=Wa,u.isLength=$i,u.isMap=Qa,u.isMatch=Sd,u.isMatchWith=Rd,u.isNaN=Cd,u.isNative=Ad,u.isNil=Od,u.isNull=qd,u.isNumber=Ka,u.isObject=ae,u.isObjectLike=ce,u.isPlainObject=jr,u.isRegExp=ns,u.isSafeInteger=Nd,u.isSet=Ja,u.isString=ji,u.isSymbol=Le,u.isTypedArray=cr,u.isUndefined=xd,u.isWeakMap=Dd,u.isWeakSet=Td,u.join=jp,u.kebabCase=bg,u.last=Qe,u.lastIndexOf=Mp,u.lowerCase=Pg,u.lowerFirst=Sg,u.lt=$d,u.lte=jd,u.max=_v,u.maxBy=wv,u.mean=Ev,u.meanBy=Iv,u.min=bv,u.minBy=Pv,u.stubArray=ps,u.stubFalse=fs,u.stubObject=uv,u.stubString=hv,u.stubTrue=lv,u.multiply=Sv,u.nth=Lp,u.noConflict=tv,u.noop=ls,u.now=xi,u.pad=Rg,u.padEnd=Cg,u.padStart=Ag,u.parseInt=qg,u.random=yg,u.reduce=Vf,u.reduceRight=Ff,u.repeat=Og,u.replace=Ng,u.result=cg,u.round=Rv,u.runInContext=d,u.sample=Bf,u.size=Qf,u.snakeCase=xg,u.some=Kf,u.sortedIndex=Bp,u.sortedIndexBy=Gp,u.sortedIndexOf=Wp,u.sortedLastIndex=Qp,u.sortedLastIndexBy=Kp,u.sortedLastIndexOf=Jp,u.startCase=Tg,u.startsWith=$g,u.subtract=Cv,u.sum=Av,u.sumBy=qv,u.template=jg,u.times=pv,u.toFinite=mt,u.toInteger=L,u.toLength=Za,u.toLower=Mg,u.toNumber=Ke,u.toSafeInteger=Md,u.toString=K,u.toUpper=Lg,u.trim=Hg,u.trimEnd=Ug,u.trimStart=kg,u.truncate=Vg,u.unescape=Fg,u.uniqueId=dv,u.upperCase=zg,u.upperFirst=as,u.each=La,u.eachRight=Ha,u.first=Ta,hs(u,function(){var e={};return nt(u,function(t,r){Z.call(u.prototype,r)||(e[r]=t)}),e}(),{chain:!1}),u.VERSION=o,Fe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){u[e].placeholder=u}),Fe(["drop","take"],function(e,t){G.prototype[e]=function(r){r=r===i?1:ge(L(r),0);var s=this.__filtered__&&!t?new G(this):this.clone();return s.__filtered__?s.__takeCount__=Ie(r,s.__takeCount__):s.__views__.push({size:Ie(r,Ee),type:e+(s.__dir__<0?"Right":"")}),s},G.prototype[e+"Right"]=function(r){return this.reverse()[e](r).reverse()}}),Fe(["filter","map","takeWhile"],function(e,t){var r=t+1,s=r==m||r==U;G.prototype[e]=function(a){var h=this.clone();return h.__iteratees__.push({iteratee:N(a,3),type:r}),h.__filtered__=h.__filtered__||s,h}}),Fe(["head","last"],function(e,t){var r="take"+(t?"Right":"");G.prototype[e]=function(){return this[r](1).value()[0]}}),Fe(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");G.prototype[e]=function(){return this.__filtered__?new G(this):this[r](1)}}),G.prototype.compact=function(){return this.filter(xe)},G.prototype.find=function(e){return this.filter(e).head()},G.prototype.findLast=function(e){return this.reverse().find(e)},G.prototype.invokeMap=z(function(e,t){return typeof e=="function"?new G(this):this.map(function(r){return Or(r,e,t)})}),G.prototype.reject=function(e){return this.filter(Ti(N(e)))},G.prototype.slice=function(e,t){e=L(e);var r=this;return r.__filtered__&&(e>0||t<0)?new G(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==i&&(t=L(t),r=t<0?r.dropRight(-t):r.take(t-e)),r)},G.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},G.prototype.toArray=function(){return this.take(Ee)},nt(G.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),s=/^(?:head|last)$/.test(t),a=u[s?"take"+(t=="last"?"Right":""):t],h=s||/^find/.test(t);a&&(u.prototype[t]=function(){var l=this.__wrapped__,p=s?[1]:arguments,g=l instanceof G,w=p[0],E=g||$(l),b=function(B){var W=a.apply(u,bt([B],p));return s&&C?W[0]:W};E&&r&&typeof w=="function"&&w.length!=1&&(g=E=!1);var C=this.__chain__,O=!!this.__actions__.length,x=h&&!C,k=g&&!O;if(!h&&E){l=k?l:new G(this);var D=e.apply(l,p);return D.__actions__.push({func:Oi,args:[b],thisArg:i}),new Be(D,C)}return x&&k?e.apply(this,p):(D=this.thru(b),x?s?D.value()[0]:D.value():D)})}),Fe(["pop","push","shift","sort","splice","unshift"],function(e){var t=ri[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);u.prototype[e]=function(){var a=arguments;if(s&&!this.__chain__){var h=this.value();return t.apply($(h)?h:[],a)}return this[r](function(l){return t.apply($(l)?l:[],a)})}}),nt(G.prototype,function(e,t){var r=u[t];if(r){var s=r.name+"";Z.call(ir,s)||(ir[s]=[]),ir[s].push({name:t,func:r})}}),ir[bi(i,Ae).name]=[{name:"wrapper",func:i}],G.prototype.clone=Vh,G.prototype.reverse=Fh,G.prototype.value=zh,u.prototype.at=wf,u.prototype.chain=Ef,u.prototype.commit=If,u.prototype.next=bf,u.prototype.plant=Sf,u.prototype.reverse=Rf,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Cf,u.prototype.first=u.prototype.head,br&&(u.prototype[br]=Pf),u},er=Eh();Tt?((Tt.exports=er)._=er,un._=er):me._=er}).call(Vr)})(Ss,Ss.exports);var $m=Object.defineProperty,jm=Object.defineProperties,Mm=Object.getOwnPropertyDescriptors,Pc=Object.getOwnPropertySymbols,Lm=Object.prototype.hasOwnProperty,Hm=Object.prototype.propertyIsEnumerable,Sc=(P,n,i)=>n in P?$m(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,Ui=(P,n)=>{for(var i in n||(n={}))Lm.call(n,i)&&Sc(P,i,n[i]);if(Pc)for(var i of Pc(n))Hm.call(n,i)&&Sc(P,i,n[i]);return P},Um=(P,n)=>jm(P,Mm(n));function Nt(P,n,i){var o;const c=lm(P);return((o=n.rpcMap)==null?void 0:o[c.reference])||`${Tm}?chainId=${c.namespace}:${c.reference}&projectId=${i}`}function Gt(P){return P.includes(":")?P.split(":")[1]:P}function Uc(P){return P.map(n=>`${n.split(":")[0]}:${n.split(":")[1]}`)}function km(P,n){const i=Object.keys(n.namespaces).filter(c=>c.includes(P));if(!i.length)return[];const o=[];return i.forEach(c=>{const f=n.namespaces[c].accounts;o.push(...f)}),o}function Vm(P={},n={}){const i=Rc(P),o=Rc(n);return Ss.exports.merge(i,o)}function Rc(P){var n,i,o,c;const f={};if(!Vi(P))return f;for(const[y,I]of Object.entries(P)){const R=Tc(y)?[y]:I.chains,q=I.methods||[],j=I.events||[],M=I.rpcMap||{},H=Fr(y);f[H]=Um(Ui(Ui({},f[H]),I),{chains:ms(R,(n=f[H])==null?void 0:n.chains),methods:ms(q,(i=f[H])==null?void 0:i.methods),events:ms(j,(o=f[H])==null?void 0:o.events),rpcMap:Ui(Ui({},M),(c=f[H])==null?void 0:c.rpcMap)})}return f}function Fm(P){return P.includes(":")?P.split(":")[2]:P}function zm(P){const n={};for(const[i,o]of Object.entries(P)){const c=o.methods||[],f=o.events||[],y=o.accounts||[],I=Tc(i)?[i]:o.chains?o.chains:Uc(o.accounts);n[i]={chains:I,methods:c,events:f,accounts:y}}return n}function ws(P){return typeof P=="number"?P:P.includes("0x")?parseInt(P,16):P.includes(":")?Number(P.split(":")[1]):Number(P)}const kc={},oe=P=>kc[P],Es=(P,n)=>{kc[P]=n};class Bm{constructor(n){this.name="polkadot",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getAccounts(){const n=this.namespace.accounts;return n?n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Gm{constructor(n){this.name="eip155",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(n){switch(n.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(n);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(n.request.method)?await this.client.request(n):this.getHttpProvider().request(n.request)}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(parseInt(n),i),this.chainId=parseInt(n),this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}createHttpProvider(n,i){const o=i||Nt(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=parseInt(Gt(i));n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const n=this.chainId,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}async handleSwitchChain(n){var i,o;let c=n.request.params?(i=n.request.params[0])==null?void 0:i.chainId:"0x0";c=c.startsWith("0x")?c:`0x${c}`;const f=parseInt(c,16);if(this.isChainApproved(f))this.setDefaultChain(`${f}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:n.topic,request:{method:n.request.method,params:[{chainId:c}]},chainId:(o=this.namespace.chains)==null?void 0:o[0]}),this.setDefaultChain(`${f}`);else throw new Error(`Failed to switch to chain 'eip155:${f}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(n){return this.namespace.chains.includes(`${this.name}:${n}`)}}class Wm{constructor(n){this.name="solana",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Qm{constructor(n){this.name="cosmos",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Km{constructor(n){this.name="cip34",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{const o=this.getCardanoRPCUrl(i),c=Gt(i);n[c]=this.createHttpProvider(c,o)}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}getCardanoRPCUrl(n){const i=this.namespace.rpcMap;if(i)return i[n]}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||this.getCardanoRPCUrl(n);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Jm{constructor(n){this.name="elrond",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Ym{constructor(n){this.name="multiversx",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){this.httpProviders[n]||this.setHttpProvider(n,i),this.chainId=n,this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}getAccounts(){const n=this.namespace.accounts;return n?[...new Set(n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;const c=Gt(i);n[c]=this.createHttpProvider(c,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);return new xt(new Dt(o,oe("disableProviderPing")))}}class Zm{constructor(n){this.name="near",this.namespace=n.namespace,this.events=oe("events"),this.client=oe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(n){this.namespace=Object.assign(this.namespace,n)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const n=this.namespace.chains[0];if(!n)throw new Error("ChainId not found");return n.split(":")[1]}request(n){return this.namespace.methods.includes(n.request.method)?this.client.request(n):this.getHttpProvider().request(n.request)}setDefaultChain(n,i){if(this.chainId=n,!this.httpProviders[n]){const o=i||Nt(`${this.name}:${n}`,this.namespace);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.events.emit(wt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const n=this.namespace.accounts;return n?n.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const n={};return this.namespace.chains.forEach(i=>{var o;n[i]=this.createHttpProvider(i,(o=this.namespace.rpcMap)==null?void 0:o[i])}),n}getHttpProvider(){const n=`${this.name}:${this.chainId}`,i=this.httpProviders[n];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${n} not found`);return i}setHttpProvider(n,i){const o=this.createHttpProvider(n,i);o&&(this.httpProviders[n]=o)}createHttpProvider(n,i){const o=i||Nt(n,this.namespace);return typeof o>"u"?void 0:new xt(new Dt(o,oe("disableProviderPing")))}}var Xm=Object.defineProperty,ey=Object.defineProperties,ty=Object.getOwnPropertyDescriptors,Cc=Object.getOwnPropertySymbols,ry=Object.prototype.hasOwnProperty,iy=Object.prototype.propertyIsEnumerable,Ac=(P,n,i)=>n in P?Xm(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,ki=(P,n)=>{for(var i in n||(n={}))ry.call(n,i)&&Ac(P,i,n[i]);if(Cc)for(var i of Cc(n))iy.call(n,i)&&Ac(P,i,n[i]);return P},Is=(P,n)=>ey(P,ty(n));class Ns{constructor(n){this.events=new xc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=n,this.logger=typeof(n==null?void 0:n.logger)<"u"&&typeof(n==null?void 0:n.logger)!="string"?n.logger:lr.pino(lr.getDefaultLoggerOptions({level:(n==null?void 0:n.logger)||Ic})),this.disableProviderPing=(n==null?void 0:n.disableProviderPing)||!1}static async init(n){const i=new Ns(n);return await i.initialize(),i}async request(n,i){const[o,c]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:ki({},n),chainId:`${o}:${c}`,topic:this.session.topic})}sendAsync(n,i,o){this.request(n,o).then(c=>i(null,c)).catch(c=>i(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var n;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(n=this.session)==null?void 0:n.topic,reason:at("USER_DISCONNECTED")}),await this.cleanup()}async connect(n){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(n),await this.cleanupPendingPairings(),!n.skipPairing)return await this.pair(n.pairingTopic)}on(n,i){this.events.on(n,i)}once(n,i){this.events.once(n,i)}removeListener(n,i){this.events.removeListener(n,i)}off(n,i){this.events.off(n,i)}get isWalletConnect(){return!0}async pair(n){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:o,approval:c}=await this.client.connect({pairingTopic:n,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});o&&(this.uri=o,this.events.emit("display_uri",o)),await c().then(f=>{this.session=f,this.namespaces||(this.namespaces=zm(f.namespaces),this.persist("namespaces",this.namespaces))}).catch(f=>{if(f.message!==Lc)throw f;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(n,i){try{if(!this.session)return;const[o,c]=this.validateChain(n);this.getProvider(o).setDefaultChain(c,i)}catch(o){if(!/Please call connect/.test(o.message))throw o}}async cleanupPendingPairings(n={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(Br(i)){for(const o of i)n.deletePairings?this.client.core.expirer.set(o.topic,0):await this.client.core.relayer.subscriber.unsubscribe(o.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const n=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[n]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Cm.init({logger:this.providerOpts.logger||Ic,relayUrl:this.providerOpts.relayUrl||Nm,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const n=[...new Set(Object.keys(this.session.namespaces).map(i=>Fr(i)))];Es("client",this.client),Es("events",this.events),Es("disableProviderPing",this.disableProviderPing),n.forEach(i=>{if(!this.session)return;const o=km(i,this.session),c=Uc(o),f=Vm(this.namespaces,this.optionalNamespaces),y=Is(ki({},f[i]),{accounts:o,chains:c});switch(i){case"eip155":this.rpcProviders[i]=new Gm({namespace:y});break;case"solana":this.rpcProviders[i]=new Wm({namespace:y});break;case"cosmos":this.rpcProviders[i]=new Qm({namespace:y});break;case"polkadot":this.rpcProviders[i]=new Bm({namespace:y});break;case"cip34":this.rpcProviders[i]=new Km({namespace:y});break;case"elrond":this.rpcProviders[i]=new Jm({namespace:y});break;case"multiversx":this.rpcProviders[i]=new Ym({namespace:y});break;case"near":this.rpcProviders[i]=new Zm({namespace:y});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",n=>{this.events.emit("session_ping",n)}),this.client.on("session_event",n=>{const{params:i}=n,{event:o}=i;if(o.name==="accountsChanged"){const c=o.data;c&&Br(c)&&this.events.emit("accountsChanged",c.map(Fm))}else if(o.name==="chainChanged"){const c=i.chainId,f=i.event.data,y=Fr(c),I=ws(c)!==ws(f)?`${y}:${ws(f)}`:c;this.onChainChanged(I)}else this.events.emit(o.name,o.data);this.events.emit("session_event",n)}),this.client.on("session_update",({topic:n,params:i})=>{var o;const{namespaces:c}=i,f=(o=this.client)==null?void 0:o.session.get(n);this.session=Is(ki({},f),{namespaces:c}),this.onSessionUpdate(),this.events.emit("session_update",{topic:n,params:i})}),this.client.on("session_delete",async n=>{await this.cleanup(),this.events.emit("session_delete",n),this.events.emit("disconnect",Is(ki({},at("USER_DISCONNECTED")),{data:n.topic}))}),this.on(wt.DEFAULT_CHAIN_CHANGED,n=>{this.onChainChanged(n,!0)})}getProvider(n){if(!this.rpcProviders[n])throw new Error(`Provider not found: ${n}`);return this.rpcProviders[n]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(n=>{var i;this.getProvider(n).updateNamespace((i=this.session)==null?void 0:i.namespaces[n])})}setNamespaces(n){const{namespaces:i,optionalNamespaces:o,sessionProperties:c}=n;i&&Object.keys(i).length&&(this.namespaces=i),o&&Object.keys(o).length&&(this.optionalNamespaces=o),this.sessionProperties=c,this.persist("namespaces",i),this.persist("optionalNamespaces",o)}validateChain(n){const[i,o]=(n==null?void 0:n.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,o];if(i&&!Object.keys(this.namespaces||{}).map(y=>Fr(y)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&o)return[i,o];const c=Fr(Object.keys(this.namespaces)[0]),f=this.rpcProviders[c].getDefaultChain();return[c,f]}async requestAccounts(){const[n]=this.validateChain();return await this.getProvider(n).requestAccounts()}onChainChanged(n,i=!1){var o;if(!this.namespaces)return;const[c,f]=this.validateChain(n);i||this.getProvider(c).setDefaultChain(f),((o=this.namespaces[c])!=null?o:this.namespaces[`${c}:${f}`]).defaultChain=f,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",f)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(n,i){this.client.core.storage.setItem(`${bc}/${n}`,i)}async getFromStore(n){return await this.client.core.storage.getItem(`${bc}/${n}`)}}const ny=Ns,sy="wc",oy="ethereum_provider",ay=`${sy}@2:${oy}:`,cy="https://rpc.walletconnect.com/v1/",Rs=["eth_sendTransaction","personal_sign"],uy=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Cs=["chainChanged","accountsChanged"],hy=["chainChanged","accountsChanged","message","disconnect","connect"];var ly=Object.defineProperty,py=Object.defineProperties,fy=Object.getOwnPropertyDescriptors,qc=Object.getOwnPropertySymbols,dy=Object.prototype.hasOwnProperty,gy=Object.prototype.propertyIsEnumerable,Oc=(P,n,i)=>n in P?ly(P,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):P[n]=i,zr=(P,n)=>{for(var i in n||(n={}))dy.call(n,i)&&Oc(P,i,n[i]);if(qc)for(var i of qc(n))gy.call(n,i)&&Oc(P,i,n[i]);return P},Nc=(P,n)=>py(P,fy(n));function Fi(P){return Number(P[0].split(":")[1])}function bs(P){return`0x${P.toString(16)}`}function vy(P){const{chains:n,optionalChains:i,methods:o,optionalMethods:c,events:f,optionalEvents:y,rpcMap:I}=P;if(!Br(n))throw new Error("Invalid chains");const R={chains:n,methods:o||Rs,events:f||Cs,rpcMap:zr({},n.length?{[Fi(n)]:I[Fi(n)]}:{})},q=f==null?void 0:f.filter(J=>!Cs.includes(J)),j=o==null?void 0:o.filter(J=>!Rs.includes(J));if(!i&&!y&&!c&&!(q!=null&&q.length)&&!(j!=null&&j.length))return{required:n.length?R:void 0};const M=(q==null?void 0:q.length)&&(j==null?void 0:j.length)||!i,H={chains:[...new Set(M?R.chains.concat(i||[]):i)],methods:[...new Set(R.methods.concat(c!=null&&c.length?c:uy))],events:[...new Set(R.events.concat(y!=null&&y.length?y:hy))],rpcMap:I};return{required:n.length?R:void 0,optional:i.length?H:void 0}}class xs{constructor(){this.events=new As.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=ay,this.on=(n,i)=>(this.events.on(n,i),this),this.once=(n,i)=>(this.events.once(n,i),this),this.removeListener=(n,i)=>(this.events.removeListener(n,i),this),this.off=(n,i)=>(this.events.off(n,i),this),this.parseAccount=n=>this.isCompatibleChainId(n)?this.parseAccountId(n).address:n,this.signer={},this.rpc={}}static async init(n){const i=new xs;return await i.initialize(n),i}async request(n){return await this.signer.request(n,this.formatChainId(this.chainId))}sendAsync(n,i){this.signer.sendAsync(n,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(n){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(n);const{required:i,optional:o}=vy(this.rpc);try{const c=await new Promise(async(y,I)=>{var R;this.rpc.showQrModal&&((R=this.modal)==null||R.subscribeModal(q=>{!q.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),I(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Nc(zr({namespaces:zr({},i&&{[this.namespace]:i})},o&&{optionalNamespaces:{[this.namespace]:o}}),{pairingTopic:n==null?void 0:n.pairingTopic})).then(q=>{y(q)}).catch(q=>{I(new Error(q.message))})});if(!c)return;const f=pm(c.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:f),this.setAccounts(f),this.events.emit("connect",{chainId:bs(this.chainId)})}catch(c){throw this.signer.logger.error(c),c}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",n=>{const{params:i}=n,{event:o}=i;o.name==="accountsChanged"?(this.accounts=this.parseAccounts(o.data),this.events.emit("accountsChanged",this.accounts)):o.name==="chainChanged"?this.setChainId(this.formatChainId(o.data)):this.events.emit(o.name,o.data),this.events.emit("session_event",n)}),this.signer.on("chainChanged",n=>{const i=parseInt(n);this.chainId=i,this.events.emit("chainChanged",bs(this.chainId)),this.persist()}),this.signer.on("session_update",n=>{this.events.emit("session_update",n)}),this.signer.on("session_delete",n=>{this.reset(),this.events.emit("session_delete",n),this.events.emit("disconnect",Nc(zr({},at("USER_DISCONNECTED")),{data:n.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",n=>{var i,o;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(o=this.modal)==null||o.openModal({uri:n})),this.events.emit("display_uri",n)})}switchEthereumChain(n){this.request({method:"wallet_switchEthereumChain",params:[{chainId:n.toString(16)}]})}isCompatibleChainId(n){return typeof n=="string"?n.startsWith(`${this.namespace}:`):!1}formatChainId(n){return`${this.namespace}:${n}`}parseChainId(n){return Number(n.split(":")[1])}setChainIds(n){const i=n.filter(o=>this.isCompatibleChainId(o)).map(o=>this.parseChainId(o));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",bs(this.chainId)),this.persist())}setChainId(n){if(this.isCompatibleChainId(n)){const i=this.parseChainId(n);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(n){const[i,o,c]=n.split(":");return{chainId:`${i}:${o}`,address:c}}setAccounts(n){this.accounts=n.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(n){var i,o;const c=(i=n==null?void 0:n.chains)!=null?i:[],f=(o=n==null?void 0:n.optionalChains)!=null?o:[],y=c.concat(f);if(!y.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const I=c.length?(n==null?void 0:n.methods)||Rs:[],R=c.length?(n==null?void 0:n.events)||Cs:[],q=(n==null?void 0:n.optionalMethods)||[],j=(n==null?void 0:n.optionalEvents)||[],M=(n==null?void 0:n.rpcMap)||this.buildRpcMap(y,n.projectId),H=(n==null?void 0:n.qrModalOptions)||void 0;return{chains:c==null?void 0:c.map(J=>this.formatChainId(J)),optionalChains:f.map(J=>this.formatChainId(J)),methods:I,events:R,optionalMethods:q,optionalEvents:j,rpcMap:M,showQrModal:!!(n!=null&&n.showQrModal),qrModalOptions:H,projectId:n.projectId,metadata:n.metadata}}buildRpcMap(n,i){const o={};return n.forEach(c=>{o[c]=this.getRpcUrl(c,i)}),o}async initialize(n){if(this.rpc=this.getRpcConfig(n),this.chainId=this.rpc.chains.length?Fi(this.rpc.chains):Fi(this.rpc.optionalChains),this.signer=await ny.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:n.disableProviderPing,relayUrl:n.relayUrl,storageOptions:n.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:o}=await xv(()=>import("./index-J9wXjoo7.js").then(c=>c.i),__vite__mapDeps([0,1,2]));i=o}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(zr({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(o){throw this.signer.logger.error(o),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(n){if(!n)return;const{chains:i,optionalChains:o,rpcMap:c}=n;i&&Br(i)&&(this.rpc.chains=i.map(f=>this.formatChainId(f)),i.forEach(f=>{this.rpc.rpcMap[f]=(c==null?void 0:c[f])||this.getRpcUrl(f)})),o&&Br(o)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=o==null?void 0:o.map(f=>this.formatChainId(f)),o.forEach(f=>{this.rpc.rpcMap[f]=(c==null?void 0:c[f])||this.getRpcUrl(f)}))}getRpcUrl(n,i){var o;return((o=this.rpc.rpcMap)==null?void 0:o[n])||`${cy}?chainId=eip155:${n}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const n=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${n}`]?this.session.namespaces[`${this.namespace}:${n}`]:this.session.namespaces[this.namespace];this.setChainIds(n?[this.formatChainId(n)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(n){return typeof n=="string"||n instanceof String?[this.parseAccount(n)]:n.map(i=>this.parseAccount(i))}}const wy=xs;export{wy as EthereumProvider,hy as OPTIONAL_EVENTS,uy as OPTIONAL_METHODS,Cs as REQUIRED_EVENTS,Rs as REQUIRED_METHODS,xs as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-J9wXjoo7.js","assets/index-OE56k1X-.js","assets/index-Zpn9ZsWz.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}